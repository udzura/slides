<!DOCTYPE html><html lang="ja-JP"><head><title>Running ruby.wasm on Pure Ruby Wasm Runtime</title><meta property="og:title" content="Running ruby.wasm on Pure Ruby Wasm Runtime"><meta property="og:image:alt" content="Running ruby.wasm on Pure Ruby Wasm Runtime"><meta name="description" content="On RubyKaigi 2025 Matzyama / Running ruby.wasm on Pure Ruby Wasm Runtime"><meta property="og:description" content="On RubyKaigi 2025 Matzyama / Running ruby.wasm on Pure Ruby Wasm Runtime"><meta property="og:image" content="https://udzura.jp/slides/2025/rubykaigi/ogp.png"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary_large_image"><style>@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button{appearance:none;background-color:initial;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear;-webkit-tap-highlight-color:transparent}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTAgMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJtMzIgOTAgNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgeD0iMTAiIHk9IjIwIiBjbGFzcz0iYSIgcng9IjUuNjciLz48cGF0aCBkPSJNNDAgNzBIMjBWNTBtMjAgMEwyMCA3MG00MC00MGgyMHYyMG0tMjAgMCAyMC0yMCIgY2xhc3M9ImEiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgeD0iMTAiIHk9IjIwIiBjbGFzcz0iYSIgcng9IjUuNjciLz48cGF0aCBkPSJNMjAgNTBoMjB2MjBtLTIwIDAgMjAtMjBtNDAgMEg2MFYzMG0yMCAwTDYwIDUwIiBjbGFzcz0iYSIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNODcuOCA0Ny41Qzg5IDUwIDg3LjcgNTIgODUgNTJIMzVhOC43IDguNyAwIDAgMS03LjItNC41bC0xNS42LTMxQzExIDE0IDEyLjIgMTIgMTUgMTJoNTBhOC44IDguOCAwIDAgMSA3LjIgNC41ek02MCA1MnYzNm0tMTAgMGgyME00NSA0MmgyMCIvPjwvc3ZnPg==") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button.bespoke-marp-presenter-note-bigger{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMTIgNTBoODBNNTIgOTBWMTAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button.bespoke-marp-presenter-note-smaller{background:#0000 url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMTIgNTBoODAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}}@keyframes __bespoke_marp_transition_reduced_outgoing__{0%{opacity:1}to{opacity:0}}@keyframes __bespoke_marp_transition_reduced_incoming__{0%{mix-blend-mode:plus-lighter;opacity:0}to{mix-blend-mode:plus-lighter;opacity:1}}.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{::view-transition-group(*){animation-duration:var(--marp-bespoke-transition-animation-duration,.5s);animation-timing-function:ease}::view-transition-new(*),::view-transition-old(*){animation-delay:0s;animation-direction:var(--marp-bespoke-transition-animation-direction,normal);animation-duration:var(--marp-bespoke-transition-animation-duration,.5s);animation-fill-mode:both;animation-name:var(--marp-bespoke-transition-animation-name,var(--marp-bespoke-transition-animation-name-fallback,__bespoke_marp_transition_no_animation__));mix-blend-mode:normal}::view-transition-old(*){--marp-bespoke-transition-animation-name-fallback:__bespoke_marp_transition_reduced_outgoing__;animation-timing-function:ease}::view-transition-new(*){--marp-bespoke-transition-animation-name-fallback:__bespoke_marp_transition_reduced_incoming__;animation-timing-function:ease}::view-transition-new(root),::view-transition-old(root){animation-timing-function:linear}::view-transition-new(__bespoke_marp_transition_osc__),::view-transition-old(__bespoke_marp_transition_osc__){animation-duration:0s!important;animation-name:__bespoke_marp_transition_osc__!important}::view-transition-new(__bespoke_marp_transition_osc__){opacity:0!important}.bespoke-marp-transition-warming-up::view-transition-group(*),.bespoke-marp-transition-warming-up::view-transition-new(*),.bespoke-marp-transition-warming-up::view-transition-old(*){animation-play-state:paused!important}body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{content-visibility:hidden;opacity:0;pointer-events:none;z-index:-1}svg.bespoke-marp-slide:not(.bespoke-marp-active) *{view-transition-name:none!important}svg.bespoke-marp-slide.bespoke-marp-active{content-visibility:visible;opacity:1;pointer-events:auto;z-index:0}svg.bespoke-marp-slide.bespoke-marp-active.bespoke-marp-active-ready *{animation-name:__bespoke_marp__!important}@supports not (content-visibility:hidden){svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}}}@media screen and (prefers-reduced-motion:reduce){svg.bespoke-marp-slide *{view-transition-name:none!important}}@media screen{[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{inset:0;position:absolute}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:#000000a6;border-radius:7px;bottom:50px;color:#fff;contain:paint;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;user-select:none;white-space:nowrap;will-change:transform;z-index:1;view-transition-name:__bespoke_marp_transition_osc__}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{background:#0288d1;flex:0 0 0;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:#0000}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{display:grid;font-family:Helvetica,Arial,sans-serif;grid-template:"current dragbar next" minmax(140px,1fr) "current dragbar note" 2fr "info    dragbar note" 3em;grid-template-columns:minmax(3px,var(--bespoke-marp-presenter-split-ratio,66%)) 0 minmax(3px,1fr);height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-dragbar-container{background:#0288d1;cursor:col-resize;grid-area:dragbar;margin-left:-3px;opacity:0;position:relative;transition:opacity .4s linear .1s;width:6px;z-index:10}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-dragbar-container:hover{opacity:1}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-dragbar-container.active{opacity:1;transition-delay:0s}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:#0000;border:0;display:block;filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;pointer-events:none;position:absolute;top:20px;-webkit-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#eee;grid-area:note;position:relative;z-index:1}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-wrapper{display:block;inset:0;position:absolute}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-buttons{background:#000000a6;border-radius:4px;bottom:0;display:flex;gap:4px;margin:12px;opacity:0;padding:6px;pointer-events:none;position:absolute;right:0;transition:opacity .2s linear}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-buttons:focus-within,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-presenter-note-wrapper:focus-within+.bespoke-marp-presenter-note-buttons,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container:hover .bespoke-marp-presenter-note-buttons{opacity:1;pointer-events:auto}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{box-sizing:border-box;font-size:calc(1.1em*var(--bespoke-marp-note-font-scale, 1));height:calc(100% - 40px);margin:20px;overflow:auto;padding-right:3px;white-space:pre-wrap;width:calc(100% - 40px);word-wrap:break-word;scrollbar-color:#eeeeee80 #0000;scrollbar-width:thin}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:#0000}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:#eeeeee80;border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#eee;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;overflow:hidden;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{box-sizing:border-box;display:block;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer:hover{cursor:pointer}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>@import url('https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap');@import url('https://fonts.googleapis.com/css2?family=Hina+Mincho&display=swap');div#\:\$p > svg > foreignObject > section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center;-webkit-text-size-adjust:100%;text-size-adjust:100%}div#\:\$p > svg > foreignObject > section::after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#\:\$p > svg > foreignObject > section:not([data-marpit-pagination])::after{display:none}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1){font-size:2em;margin:0.67em 0}div#\:\$p > svg > foreignObject > section video::-webkit-media-controls{will-change:transform}@page {size:1280px 720px;margin:0}@media print{html, body{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#\:\$p > svg > foreignObject > section{page-break-before:always;break-before:page}div#\:\$p > svg > foreignObject > section, div#\:\$p > svg > foreignObject > section *{-webkit-print-color-adjust:exact!important;animation-delay:0s!important;animation-duration:0s!important;color-adjust:exact!important;transition:none!important}div#\:\$p > svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}/*!
 * Marp default theme.
 *
 * @theme default
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 16:9 1280px 720px
 * @size 4:3 960px 720px
 */div#\:\$p > svg > foreignObject > section{--base-size-4:calc(var(--marpit-root-font-size, 1rem) * 0.25);--base-size-8:calc(var(--marpit-root-font-size, 1rem) * 0.5);--base-size-16:calc(var(--marpit-root-font-size, 1rem) * 1);--base-size-24:calc(var(--marpit-root-font-size, 1rem) * 1.5);--base-size-40:calc(var(--marpit-root-font-size, 1rem) * 2.5);--base-text-weight-normal:400;--base-text-weight-medium:500;--base-text-weight-semibold:600;--fontStack-monospace:ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;--fgColor-accent:Highlight;}div#\:\$p > svg > foreignObject > section [data-theme=light],div#\:\$p > svg > foreignObject > section{color-scheme:light;--focus-outlineColor:#0969da;--fgColor-default:#1f2328;--fgColor-muted:#59636e;--fgColor-accent:#0969da;--fgColor-success:#1a7f37;--fgColor-attention:#9a6700;--fgColor-danger:#d1242f;--fgColor-done:#8250df;--bgColor-default:#fff;--bgColor-muted:#f6f8fa;--bgColor-neutral-muted:#818b981f;--bgColor-attention-muted:#fff8c5;--borderColor-default:#d1d9e0;--borderColor-muted:#d1d9e0b3;--borderColor-neutral-muted:#d1d9e0b3;--borderColor-accent-emphasis:#0969da;--borderColor-success-emphasis:#1a7f37;--borderColor-attention-emphasis:#9a6700;--borderColor-danger-emphasis:#cf222e;--borderColor-done-emphasis:#8250df;--color-prettylights-syntax-comment:#59636e;--color-prettylights-syntax-constant:#0550ae;--color-prettylights-syntax-constant-other-reference-link:#0a3069;--color-prettylights-syntax-entity:#6639ba;--color-prettylights-syntax-storage-modifier-import:#1f2328;--color-prettylights-syntax-entity-tag:#0550ae;--color-prettylights-syntax-keyword:#cf222e;--color-prettylights-syntax-string:#0a3069;--color-prettylights-syntax-variable:#953800;--color-prettylights-syntax-brackethighlighter-unmatched:#82071e;--color-prettylights-syntax-brackethighlighter-angle:#59636e;--color-prettylights-syntax-invalid-illegal-text:#f6f8fa;--color-prettylights-syntax-invalid-illegal-bg:#82071e;--color-prettylights-syntax-carriage-return-text:#f6f8fa;--color-prettylights-syntax-carriage-return-bg:#cf222e;--color-prettylights-syntax-string-regexp:#116329;--color-prettylights-syntax-markup-list:#3b2300;--color-prettylights-syntax-markup-heading:#0550ae;--color-prettylights-syntax-markup-italic:#1f2328;--color-prettylights-syntax-markup-bold:#1f2328;--color-prettylights-syntax-markup-deleted-text:#82071e;--color-prettylights-syntax-markup-deleted-bg:#ffebe9;--color-prettylights-syntax-markup-inserted-text:#116329;--color-prettylights-syntax-markup-inserted-bg:#dafbe1;--color-prettylights-syntax-markup-changed-text:#953800;--color-prettylights-syntax-markup-changed-bg:#ffd8b5;--color-prettylights-syntax-markup-ignored-text:#d1d9e0;--color-prettylights-syntax-markup-ignored-bg:#0550ae;--color-prettylights-syntax-meta-diff-range:#8250df;--color-prettylights-syntax-sublimelinter-gutter-mark:#818b98;}div#\:\$p > svg > foreignObject > section [data-theme=dark],div#\:\$p > svg > foreignObject > section:where(.invert){color-scheme:dark;--focus-outlineColor:#1f6feb;--fgColor-default:#f0f6fc;--fgColor-muted:#9198a1;--fgColor-accent:#4493f8;--fgColor-success:#3fb950;--fgColor-attention:#d29922;--fgColor-danger:#f85149;--fgColor-done:#ab7df8;--bgColor-default:#0d1117;--bgColor-muted:#151b23;--bgColor-neutral-muted:#656c7633;--bgColor-attention-muted:#bb800926;--borderColor-default:#3d444d;--borderColor-muted:#3d444db3;--borderColor-neutral-muted:#3d444db3;--borderColor-accent-emphasis:#1f6feb;--borderColor-success-emphasis:#238636;--borderColor-attention-emphasis:#9e6a03;--borderColor-danger-emphasis:#da3633;--borderColor-done-emphasis:#8957e5;--color-prettylights-syntax-comment:#9198a1;--color-prettylights-syntax-constant:#79c0ff;--color-prettylights-syntax-constant-other-reference-link:#a5d6ff;--color-prettylights-syntax-entity:#d2a8ff;--color-prettylights-syntax-storage-modifier-import:#f0f6fc;--color-prettylights-syntax-entity-tag:#7ee787;--color-prettylights-syntax-keyword:#ff7b72;--color-prettylights-syntax-string:#a5d6ff;--color-prettylights-syntax-variable:#ffa657;--color-prettylights-syntax-brackethighlighter-unmatched:#f85149;--color-prettylights-syntax-brackethighlighter-angle:#9198a1;--color-prettylights-syntax-invalid-illegal-text:#f0f6fc;--color-prettylights-syntax-invalid-illegal-bg:#8e1519;--color-prettylights-syntax-carriage-return-text:#f0f6fc;--color-prettylights-syntax-carriage-return-bg:#b62324;--color-prettylights-syntax-string-regexp:#7ee787;--color-prettylights-syntax-markup-list:#f2cc60;--color-prettylights-syntax-markup-heading:#1f6feb;--color-prettylights-syntax-markup-italic:#f0f6fc;--color-prettylights-syntax-markup-bold:#f0f6fc;--color-prettylights-syntax-markup-deleted-text:#ffdcd7;--color-prettylights-syntax-markup-deleted-bg:#67060c;--color-prettylights-syntax-markup-inserted-text:#aff5b4;--color-prettylights-syntax-markup-inserted-bg:#033a16;--color-prettylights-syntax-markup-changed-text:#ffdfb6;--color-prettylights-syntax-markup-changed-bg:#5a1e02;--color-prettylights-syntax-markup-ignored-text:#f0f6fc;--color-prettylights-syntax-markup-ignored-bg:#1158c7;--color-prettylights-syntax-meta-diff-range:#d2a8ff;--color-prettylights-syntax-sublimelinter-gutter-mark:#3d444d;}div#\:\$p > svg > foreignObject > section{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;background-color:var(--bgColor-default);color:var(--fgColor-default);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Noto Sans,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;margin:0;word-wrap:break-word}div#\:\$p > svg > foreignObject > section{--marpit-root-font-size:16px;}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1):hover .anchor .octicon-link:before,div#\:\$p > svg > foreignObject > section :is(h2, marp-h2):hover .anchor .octicon-link:before,div#\:\$p > svg > foreignObject > section :is(h3, marp-h3):hover .anchor .octicon-link:before,div#\:\$p > svg > foreignObject > section :is(h4, marp-h4):hover .anchor .octicon-link:before,div#\:\$p > svg > foreignObject > section :is(h5, marp-h5):hover .anchor .octicon-link:before,div#\:\$p > svg > foreignObject > section :is(h6, marp-h6):hover .anchor .octicon-link:before{background-color:currentColor;content:" ";display:inline-block;height:16px;-webkit-mask-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 0 0 1.06 1.06l1.25-1.25a2 2 0 1 1 2.83 2.83l-2.5 2.5a2 2 0 0 1-2.83 0 .75.75 0 0 0-1.06 1.06 3.5 3.5 0 0 0 4.95 0l2.5-2.5a3.5 3.5 0 0 0-4.95-4.95zm-4.69 9.64a2 2 0 0 1 0-2.83l2.5-2.5a2 2 0 0 1 2.83 0 .75.75 0 0 0 1.06-1.06 3.5 3.5 0 0 0-4.95 0l-2.5 2.5a3.5 3.5 0 0 0 4.95 4.95l1.25-1.25a.75.75 0 0 0-1.06-1.06l-1.25 1.25a2 2 0 0 1-2.83 0"/></svg>');mask-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 0 0 1.06 1.06l1.25-1.25a2 2 0 1 1 2.83 2.83l-2.5 2.5a2 2 0 0 1-2.83 0 .75.75 0 0 0-1.06 1.06 3.5 3.5 0 0 0 4.95 0l2.5-2.5a3.5 3.5 0 0 0-4.95-4.95zm-4.69 9.64a2 2 0 0 1 0-2.83l2.5-2.5a2 2 0 0 1 2.83 0 .75.75 0 0 0 1.06-1.06 3.5 3.5 0 0 0-4.95 0l-2.5 2.5a3.5 3.5 0 0 0 4.95 4.95l1.25-1.25a.75.75 0 0 0-1.06-1.06l-1.25 1.25a2 2 0 0 1-2.83 0"/></svg>');width:16px}div#\:\$p > svg > foreignObject > section details,div#\:\$p > svg > foreignObject > section figcaption,div#\:\$p > svg > foreignObject > section figure{display:block}div#\:\$p > svg > foreignObject > section summary{display:list-item}div#\:\$p > svg > foreignObject > section [hidden]{display:none!important}div#\:\$p > svg > foreignObject > section a{background-color:transparent;color:var(--fgColor-accent);text-decoration:none}div#\:\$p > svg > foreignObject > section abbr[title]{border-bottom:none;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}div#\:\$p > svg > foreignObject > section b,div#\:\$p > svg > foreignObject > section strong{font-weight:var(--base-text-weight-semibold, 600)}div#\:\$p > svg > foreignObject > section dfn{font-style:italic}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1){border-bottom:1px solid var(--borderColor-muted);font-size:2em;font-weight:var(--base-text-weight-semibold, 600);margin:.67em 0;padding-bottom:.3em}div#\:\$p > svg > foreignObject > section mark{background-color:var(--bgColor-attention-muted);color:var(--fgColor-default)}div#\:\$p > svg > foreignObject > section small{font-size:90%}div#\:\$p > svg > foreignObject > section sub,div#\:\$p > svg > foreignObject > section sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}div#\:\$p > svg > foreignObject > section sub{bottom:-.25em}div#\:\$p > svg > foreignObject > section sup{top:-.5em}div#\:\$p > svg > foreignObject > section img{border-style:none;box-sizing:content-box;max-width:100%}div#\:\$p > svg > foreignObject > section code,div#\:\$p > svg > foreignObject > section kbd,div#\:\$p > svg > foreignObject > section :is(pre, marp-pre),div#\:\$p > svg > foreignObject > section samp{font-family:monospace;font-size:1em}div#\:\$p > svg > foreignObject > section figure{margin:1em var(--base-size-40)}div#\:\$p > svg > foreignObject > section hr{background:transparent;background-color:var(--borderColor-default);border:0;box-sizing:content-box;height:.25em;margin:var(--base-size-24) 0;overflow:hidden;padding:0}div#\:\$p > svg > foreignObject > section input{font:inherit;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible}div#\:\$p > svg > foreignObject > section [type=button],div#\:\$p > svg > foreignObject > section [type=reset],div#\:\$p > svg > foreignObject > section [type=submit]{-webkit-appearance:button;-moz-appearance:button;appearance:button}div#\:\$p > svg > foreignObject > section [type=checkbox],div#\:\$p > svg > foreignObject > section [type=radio]{box-sizing:border-box;padding:0}div#\:\$p > svg > foreignObject > section [type=number]::-webkit-inner-spin-button,div#\:\$p > svg > foreignObject > section [type=number]::-webkit-outer-spin-button{height:auto}div#\:\$p > svg > foreignObject > section [type=search]::-webkit-search-cancel-button,div#\:\$p > svg > foreignObject > section [type=search]::-webkit-search-decoration{-webkit-appearance:none;appearance:none}div#\:\$p > svg > foreignObject > section ::-webkit-input-placeholder{color:inherit;opacity:.54}div#\:\$p > svg > foreignObject > section ::-webkit-file-upload-button{-webkit-appearance:button;appearance:button;font:inherit}div#\:\$p > svg > foreignObject > section a:hover{text-decoration:underline}div#\:\$p > svg > foreignObject > section ::-moz-placeholder{color:var(--fgColor-muted);opacity:1}div#\:\$p > svg > foreignObject > section ::placeholder{color:var(--fgColor-muted);opacity:1}div#\:\$p > svg > foreignObject > section hr:after,div#\:\$p > svg > foreignObject > section hr:before{content:"";display:table}div#\:\$p > svg > foreignObject > section hr:after{clear:both}div#\:\$p > svg > foreignObject > section table{border-collapse:collapse;border-spacing:0;display:block;font-variant:tabular-nums;max-width:100%;overflow:auto;width:-moz-max-content;width:max-content}div#\:\$p > svg > foreignObject > section td,div#\:\$p > svg > foreignObject > section th{padding:0}div#\:\$p > svg > foreignObject > section details summary{cursor:pointer}div#\:\$p > svg > foreignObject > section [role=button]:focus,div#\:\$p > svg > foreignObject > section a:focus,div#\:\$p > svg > foreignObject > section input[type=checkbox]:focus,div#\:\$p > svg > foreignObject > section input[type=radio]:focus{box-shadow:none;outline:2px solid var(--focus-outlineColor);outline-offset:-2px}div#\:\$p > svg > foreignObject > section [role=button]:focus:not(:focus-visible),div#\:\$p > svg > foreignObject > section a:focus:not(:focus-visible),div#\:\$p > svg > foreignObject > section input[type=checkbox]:focus:not(:focus-visible),div#\:\$p > svg > foreignObject > section input[type=radio]:focus:not(:focus-visible){outline:1px solid transparent}div#\:\$p > svg > foreignObject > section [role=button]:focus-visible,div#\:\$p > svg > foreignObject > section a:focus-visible,div#\:\$p > svg > foreignObject > section input[type=checkbox]:focus-visible,div#\:\$p > svg > foreignObject > section input[type=radio]:focus-visible{box-shadow:none;outline:2px solid var(--focus-outlineColor);outline-offset:-2px}div#\:\$p > svg > foreignObject > section a:not([class]):focus,div#\:\$p > svg > foreignObject > section a:not([class]):focus-visible,div#\:\$p > svg > foreignObject > section input[type=checkbox]:focus,div#\:\$p > svg > foreignObject > section input[type=checkbox]:focus-visible,div#\:\$p > svg > foreignObject > section input[type=radio]:focus,div#\:\$p > svg > foreignObject > section input[type=radio]:focus-visible{outline-offset:0}div#\:\$p > svg > foreignObject > section kbd{background-color:var(--bgColor-muted);border-bottom-color:var(--borderColor-neutral-muted);border:1px solid var(--borderColor-neutral-muted);border-radius:6px;box-shadow:inset 0 -1px 0 var(--borderColor-neutral-muted);color:var(--fgColor-default);display:inline-block;font:11px var(--fontStack-monospace, ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace);line-height:10px;padding:var(--base-size-4);vertical-align:middle}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1),div#\:\$p > svg > foreignObject > section :is(h2, marp-h2),div#\:\$p > svg > foreignObject > section :is(h3, marp-h3),div#\:\$p > svg > foreignObject > section :is(h4, marp-h4),div#\:\$p > svg > foreignObject > section :is(h5, marp-h5),div#\:\$p > svg > foreignObject > section :is(h6, marp-h6){font-weight:var(--base-text-weight-semibold, 600);line-height:1.25;margin-bottom:var(--base-size-16);margin-top:var(--base-size-24)}div#\:\$p > svg > foreignObject > section :is(h2, marp-h2){border-bottom:1px solid var(--borderColor-muted);font-size:1.5em;padding-bottom:.3em}div#\:\$p > svg > foreignObject > section :is(h2, marp-h2),div#\:\$p > svg > foreignObject > section :is(h3, marp-h3){font-weight:var(--base-text-weight-semibold, 600)}div#\:\$p > svg > foreignObject > section :is(h3, marp-h3){font-size:1.25em}div#\:\$p > svg > foreignObject > section :is(h4, marp-h4){font-size:1em}div#\:\$p > svg > foreignObject > section :is(h4, marp-h4),div#\:\$p > svg > foreignObject > section :is(h5, marp-h5){font-weight:var(--base-text-weight-semibold, 600)}div#\:\$p > svg > foreignObject > section :is(h5, marp-h5){font-size:.875em}div#\:\$p > svg > foreignObject > section :is(h6, marp-h6){color:var(--fgColor-muted);font-size:.85em;font-weight:var(--base-text-weight-semibold, 600)}div#\:\$p > svg > foreignObject > section p{margin-bottom:10px;margin-top:0}div#\:\$p > svg > foreignObject > section blockquote{border-left:.25em solid var(--borderColor-default);color:var(--fgColor-muted);margin:0;padding:0 1em}div#\:\$p > svg > foreignObject > section ol,div#\:\$p > svg > foreignObject > section ul{margin-bottom:0;margin-top:0;padding-left:2em}div#\:\$p > svg > foreignObject > section ol ol,div#\:\$p > svg > foreignObject > section ul ol{list-style-type:lower-roman}div#\:\$p > svg > foreignObject > section ol ol ol,div#\:\$p > svg > foreignObject > section ol ul ol,div#\:\$p > svg > foreignObject > section ul ol ol,div#\:\$p > svg > foreignObject > section ul ul ol{list-style-type:lower-alpha}div#\:\$p > svg > foreignObject > section dd{margin-left:0}div#\:\$p > svg > foreignObject > section code,div#\:\$p > svg > foreignObject > section :is(pre, marp-pre),div#\:\$p > svg > foreignObject > section samp,div#\:\$p > svg > foreignObject > section tt{font-family:var(--fontStack-monospace, ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace);font-size:12px}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre){margin-bottom:0;margin-top:0;word-wrap:normal}div#\:\$p > svg > foreignObject > section .octicon{display:inline-block;overflow:visible!important;vertical-align:text-bottom;fill:currentColor}div#\:\$p > svg > foreignObject > section input::-webkit-inner-spin-button,div#\:\$p > svg > foreignObject > section input::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}div#\:\$p > svg > foreignObject > section .mr-2{margin-right:var(--base-size-8, 8px)!important}div#\:\$p > svg > foreignObject > section:after,div#\:\$p > svg > foreignObject > section:before{display:table}div#\:\$p > svg > foreignObject > section:after{clear:both}div#\:\$p > svg > foreignObject > section>:first-child{margin-top:0!important}div#\:\$p > svg > foreignObject > section>:last-child{margin-bottom:0!important}div#\:\$p > svg > foreignObject > section a:not([href]){color:inherit;text-decoration:none}div#\:\$p > svg > foreignObject > section .absent{color:var(--fgColor-danger)}div#\:\$p > svg > foreignObject > section .anchor{float:left;line-height:1;margin-left:-20px;padding-right:var(--base-size-4)}div#\:\$p > svg > foreignObject > section .anchor:focus{outline:none}div#\:\$p > svg > foreignObject > section blockquote,div#\:\$p > svg > foreignObject > section details,div#\:\$p > svg > foreignObject > section dl,div#\:\$p > svg > foreignObject > section ol,div#\:\$p > svg > foreignObject > section p,div#\:\$p > svg > foreignObject > section :is(pre, marp-pre),div#\:\$p > svg > foreignObject > section table,div#\:\$p > svg > foreignObject > section ul{margin-bottom:var(--base-size-16);margin-top:0}div#\:\$p > svg > foreignObject > section blockquote>:first-child{margin-top:0}div#\:\$p > svg > foreignObject > section blockquote>:last-child{margin-bottom:0}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1) .octicon-link,div#\:\$p > svg > foreignObject > section :is(h2, marp-h2) .octicon-link,div#\:\$p > svg > foreignObject > section :is(h3, marp-h3) .octicon-link,div#\:\$p > svg > foreignObject > section :is(h4, marp-h4) .octicon-link,div#\:\$p > svg > foreignObject > section :is(h5, marp-h5) .octicon-link,div#\:\$p > svg > foreignObject > section :is(h6, marp-h6) .octicon-link{color:var(--fgColor-default);vertical-align:middle;visibility:hidden}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1):hover .anchor,div#\:\$p > svg > foreignObject > section :is(h2, marp-h2):hover .anchor,div#\:\$p > svg > foreignObject > section :is(h3, marp-h3):hover .anchor,div#\:\$p > svg > foreignObject > section :is(h4, marp-h4):hover .anchor,div#\:\$p > svg > foreignObject > section :is(h5, marp-h5):hover .anchor,div#\:\$p > svg > foreignObject > section :is(h6, marp-h6):hover .anchor{text-decoration:none}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1):hover .anchor .octicon-link,div#\:\$p > svg > foreignObject > section :is(h2, marp-h2):hover .anchor .octicon-link,div#\:\$p > svg > foreignObject > section :is(h3, marp-h3):hover .anchor .octicon-link,div#\:\$p > svg > foreignObject > section :is(h4, marp-h4):hover .anchor .octicon-link,div#\:\$p > svg > foreignObject > section :is(h5, marp-h5):hover .anchor .octicon-link,div#\:\$p > svg > foreignObject > section :is(h6, marp-h6):hover .anchor .octicon-link{visibility:visible}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1) code,div#\:\$p > svg > foreignObject > section :is(h1, marp-h1) tt,div#\:\$p > svg > foreignObject > section :is(h2, marp-h2) code,div#\:\$p > svg > foreignObject > section :is(h2, marp-h2) tt,div#\:\$p > svg > foreignObject > section :is(h3, marp-h3) code,div#\:\$p > svg > foreignObject > section :is(h3, marp-h3) tt,div#\:\$p > svg > foreignObject > section :is(h4, marp-h4) code,div#\:\$p > svg > foreignObject > section :is(h4, marp-h4) tt,div#\:\$p > svg > foreignObject > section :is(h5, marp-h5) code,div#\:\$p > svg > foreignObject > section :is(h5, marp-h5) tt,div#\:\$p > svg > foreignObject > section :is(h6, marp-h6) code,div#\:\$p > svg > foreignObject > section :is(h6, marp-h6) tt{font-size:inherit;padding:0 .2em}div#\:\$p > svg > foreignObject > section summary :is(h1, marp-h1),div#\:\$p > svg > foreignObject > section summary :is(h2, marp-h2),div#\:\$p > svg > foreignObject > section summary :is(h3, marp-h3),div#\:\$p > svg > foreignObject > section summary :is(h4, marp-h4),div#\:\$p > svg > foreignObject > section summary :is(h5, marp-h5),div#\:\$p > svg > foreignObject > section summary :is(h6, marp-h6){display:inline-block}div#\:\$p > svg > foreignObject > section summary :is(h1, marp-h1) .anchor,div#\:\$p > svg > foreignObject > section summary :is(h2, marp-h2) .anchor,div#\:\$p > svg > foreignObject > section summary :is(h3, marp-h3) .anchor,div#\:\$p > svg > foreignObject > section summary :is(h4, marp-h4) .anchor,div#\:\$p > svg > foreignObject > section summary :is(h5, marp-h5) .anchor,div#\:\$p > svg > foreignObject > section summary :is(h6, marp-h6) .anchor{margin-left:-40px}div#\:\$p > svg > foreignObject > section summary :is(h1, marp-h1),div#\:\$p > svg > foreignObject > section summary :is(h2, marp-h2){border-bottom:0;padding-bottom:0}div#\:\$p > svg > foreignObject > section ol.no-list,div#\:\$p > svg > foreignObject > section ul.no-list{list-style-type:none;padding:0}div#\:\$p > svg > foreignObject > section ol[type="a s"]{list-style-type:lower-alpha}div#\:\$p > svg > foreignObject > section ol[type="A s"]{list-style-type:upper-alpha}div#\:\$p > svg > foreignObject > section ol[type="i s"]{list-style-type:lower-roman}div#\:\$p > svg > foreignObject > section ol[type="I s"]{list-style-type:upper-roman}div#\:\$p > svg > foreignObject > section div>ol:not([type]),div#\:\$p > svg > foreignObject > section ol[type="1"]{list-style-type:decimal}div#\:\$p > svg > foreignObject > section ol ol,div#\:\$p > svg > foreignObject > section ol ul,div#\:\$p > svg > foreignObject > section ul ol,div#\:\$p > svg > foreignObject > section ul ul{margin-bottom:0;margin-top:0}div#\:\$p > svg > foreignObject > section li>p{margin-top:var(--base-size-16)}div#\:\$p > svg > foreignObject > section li+li{margin-top:.25em}div#\:\$p > svg > foreignObject > section dl{padding:0}div#\:\$p > svg > foreignObject > section dl dt{font-size:1em;font-style:italic;font-weight:var(--base-text-weight-semibold, 600);margin-top:var(--base-size-16);padding:0}div#\:\$p > svg > foreignObject > section dl dd{margin-bottom:var(--base-size-16);padding:0 var(--base-size-16)}div#\:\$p > svg > foreignObject > section table th{font-weight:var(--base-text-weight-semibold, 600)}div#\:\$p > svg > foreignObject > section table td,div#\:\$p > svg > foreignObject > section table th{border:1px solid var(--borderColor-default);padding:6px 13px}div#\:\$p > svg > foreignObject > section table td>:last-child{margin-bottom:0}div#\:\$p > svg > foreignObject > section table tr{background-color:var(--bgColor-default);border-top:1px solid var(--borderColor-muted)}div#\:\$p > svg > foreignObject > section table tr:nth-child(2n){background-color:var(--bgColor-muted)}div#\:\$p > svg > foreignObject > section table img{background-color:transparent}div#\:\$p > svg > foreignObject > section img[align=right]{padding-left:20px}div#\:\$p > svg > foreignObject > section img[align=left]{padding-right:20px}div#\:\$p > svg > foreignObject > section .emoji{background-color:transparent;max-width:none;vertical-align:text-top}div#\:\$p > svg > foreignObject > section :is(span, marp-span).frame,div#\:\$p > svg > foreignObject > section :is(span, marp-span).frame>:is(span, marp-span){display:block;overflow:hidden}div#\:\$p > svg > foreignObject > section :is(span, marp-span).frame>:is(span, marp-span){border:1px solid var(--borderColor-default);float:left;margin:13px 0 0;padding:7px;width:auto}div#\:\$p > svg > foreignObject > section :is(span, marp-span).frame :is(span, marp-span) img{display:block;float:left}div#\:\$p > svg > foreignObject > section :is(span, marp-span).frame :is(span, marp-span) :is(span, marp-span){clear:both;color:var(--fgColor-default);display:block;padding:5px 0 0}div#\:\$p > svg > foreignObject > section :is(span, marp-span).align-center{clear:both;display:block;overflow:hidden}div#\:\$p > svg > foreignObject > section :is(span, marp-span).align-center>:is(span, marp-span){display:block;margin:13px auto 0;overflow:hidden;text-align:center}div#\:\$p > svg > foreignObject > section :is(span, marp-span).align-center :is(span, marp-span) img{margin:0 auto;text-align:center}div#\:\$p > svg > foreignObject > section :is(span, marp-span).align-right{clear:both;display:block;overflow:hidden}div#\:\$p > svg > foreignObject > section :is(span, marp-span).align-right>:is(span, marp-span){display:block;margin:13px 0 0;overflow:hidden;text-align:right}div#\:\$p > svg > foreignObject > section :is(span, marp-span).align-right :is(span, marp-span) img{margin:0;text-align:right}div#\:\$p > svg > foreignObject > section :is(span, marp-span).float-left{display:block;float:left;margin-right:13px;overflow:hidden}div#\:\$p > svg > foreignObject > section :is(span, marp-span).float-left :is(span, marp-span){margin:13px 0 0}div#\:\$p > svg > foreignObject > section :is(span, marp-span).float-right{display:block;float:right;margin-left:13px;overflow:hidden}div#\:\$p > svg > foreignObject > section :is(span, marp-span).float-right>:is(span, marp-span){display:block;margin:13px auto 0;overflow:hidden;text-align:right}div#\:\$p > svg > foreignObject > section code,div#\:\$p > svg > foreignObject > section tt{background-color:var(--bgColor-neutral-muted);border-radius:6px;font-size:85%;margin:0;padding:.2em .4em;white-space:break-spaces}div#\:\$p > svg > foreignObject > section code br,div#\:\$p > svg > foreignObject > section tt br{display:none}div#\:\$p > svg > foreignObject > section del code{text-decoration:inherit}div#\:\$p > svg > foreignObject > section samp{font-size:85%}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) code{font-size:100%}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre)>code{background:transparent;border:0;margin:0;padding:0;white-space:pre;word-break:normal}div#\:\$p > svg > foreignObject > section .highlight{margin-bottom:var(--base-size-16)}div#\:\$p > svg > foreignObject > section .highlight :is(pre, marp-pre){margin-bottom:0;word-break:normal}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre){background-color:var(--bgColor-muted);border-radius:6px;color:var(--fgColor-default);font-size:85%;line-height:1.45;overflow:auto;padding:var(--base-size-16)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) code,div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) tt{display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0;word-wrap:normal;background-color:transparent;border:0}div#\:\$p > svg > foreignObject > section .csv-data td,div#\:\$p > svg > foreignObject > section .csv-data th{font-size:12px;line-height:1;overflow:hidden;padding:5px;text-align:left;white-space:nowrap}div#\:\$p > svg > foreignObject > section .csv-data .blob-num{background:var(--bgColor-default);border:0;padding:10px var(--base-size-8) 9px;text-align:right}div#\:\$p > svg > foreignObject > section .csv-data tr{border-top:0}div#\:\$p > svg > foreignObject > section .csv-data th{background:var(--bgColor-muted);border-top:0;font-weight:var(--base-text-weight-semibold, 600)}div#\:\$p > svg > foreignObject > section [data-footnote-ref]:before{content:"["}div#\:\$p > svg > foreignObject > section [data-footnote-ref]:after{content:"]"}div#\:\$p > svg > foreignObject > section .footnotes{border-top:1px solid var(--borderColor-default);color:var(--fgColor-muted);font-size:12px}div#\:\$p > svg > foreignObject > section div#\:\$p > svg > foreignObject > section section.footnotes{--marpit-root-font-size:12px;}div#\:\$p > svg > foreignObject > section .footnotes ol,div#\:\$p > svg > foreignObject > section .footnotes ol ul{padding-left:var(--base-size-16)}div#\:\$p > svg > foreignObject > section .footnotes ol ul{display:inline-block;margin-top:var(--base-size-16)}div#\:\$p > svg > foreignObject > section .footnotes li{position:relative}div#\:\$p > svg > foreignObject > section .footnotes li:target:before{border:2px solid var(--borderColor-accent-emphasis);border-radius:6px;bottom:calc(var(--base-size-8)*-1);content:"";left:calc(var(--base-size-24)*-1);pointer-events:none;position:absolute;right:calc(var(--base-size-8)*-1);top:calc(var(--base-size-8)*-1)}div#\:\$p > svg > foreignObject > section .footnotes li:target{color:var(--fgColor-default)}div#\:\$p > svg > foreignObject > section .footnotes .data-footnote-backref g-emoji{font-family:monospace}div#\:\$p > svg > foreignObject > section body:has(:modal){padding-right:var(--dialog-scrollgutter)!important}div#\:\$p > svg > foreignObject > section .pl-c{color:var(--color-prettylights-syntax-comment)}div#\:\$p > svg > foreignObject > section .pl-c1,div#\:\$p > svg > foreignObject > section .pl-s .pl-v{color:var(--color-prettylights-syntax-constant)}div#\:\$p > svg > foreignObject > section .pl-e,div#\:\$p > svg > foreignObject > section .pl-en{color:var(--color-prettylights-syntax-entity)}div#\:\$p > svg > foreignObject > section .pl-s .pl-s1,div#\:\$p > svg > foreignObject > section .pl-smi{color:var(--color-prettylights-syntax-storage-modifier-import)}div#\:\$p > svg > foreignObject > section .pl-ent{color:var(--color-prettylights-syntax-entity-tag)}div#\:\$p > svg > foreignObject > section .pl-k{color:var(--color-prettylights-syntax-keyword)}div#\:\$p > svg > foreignObject > section .pl-pds,div#\:\$p > svg > foreignObject > section .pl-s,div#\:\$p > svg > foreignObject > section .pl-s .pl-pse .pl-s1,div#\:\$p > svg > foreignObject > section .pl-sr,div#\:\$p > svg > foreignObject > section .pl-sr .pl-cce,div#\:\$p > svg > foreignObject > section .pl-sr .pl-sra,div#\:\$p > svg > foreignObject > section .pl-sr .pl-sre{color:var(--color-prettylights-syntax-string)}div#\:\$p > svg > foreignObject > section .pl-smw,div#\:\$p > svg > foreignObject > section .pl-v{color:var(--color-prettylights-syntax-variable)}div#\:\$p > svg > foreignObject > section .pl-bu{color:var(--color-prettylights-syntax-brackethighlighter-unmatched)}div#\:\$p > svg > foreignObject > section .pl-ii{background-color:var(--color-prettylights-syntax-invalid-illegal-bg);color:var(--color-prettylights-syntax-invalid-illegal-text)}div#\:\$p > svg > foreignObject > section .pl-c2{background-color:var(--color-prettylights-syntax-carriage-return-bg);color:var(--color-prettylights-syntax-carriage-return-text)}div#\:\$p > svg > foreignObject > section .pl-sr .pl-cce{color:var(--color-prettylights-syntax-string-regexp);font-weight:700}div#\:\$p > svg > foreignObject > section .pl-ml{color:var(--color-prettylights-syntax-markup-list)}div#\:\$p > svg > foreignObject > section .pl-mh,div#\:\$p > svg > foreignObject > section .pl-mh .pl-en,div#\:\$p > svg > foreignObject > section .pl-ms{color:var(--color-prettylights-syntax-markup-heading);font-weight:700}div#\:\$p > svg > foreignObject > section .pl-mi{color:var(--color-prettylights-syntax-markup-italic);font-style:italic}div#\:\$p > svg > foreignObject > section .pl-mb{color:var(--color-prettylights-syntax-markup-bold);font-weight:700}div#\:\$p > svg > foreignObject > section .pl-md{background-color:var(--color-prettylights-syntax-markup-deleted-bg);color:var(--color-prettylights-syntax-markup-deleted-text)}div#\:\$p > svg > foreignObject > section .pl-mi1{background-color:var(--color-prettylights-syntax-markup-inserted-bg);color:var(--color-prettylights-syntax-markup-inserted-text)}div#\:\$p > svg > foreignObject > section .pl-mc{background-color:var(--color-prettylights-syntax-markup-changed-bg);color:var(--color-prettylights-syntax-markup-changed-text)}div#\:\$p > svg > foreignObject > section .pl-mi2{background-color:var(--color-prettylights-syntax-markup-ignored-bg);color:var(--color-prettylights-syntax-markup-ignored-text)}div#\:\$p > svg > foreignObject > section .pl-mdr{color:var(--color-prettylights-syntax-meta-diff-range);font-weight:700}div#\:\$p > svg > foreignObject > section .pl-ba{color:var(--color-prettylights-syntax-brackethighlighter-angle)}div#\:\$p > svg > foreignObject > section .pl-sg{color:var(--color-prettylights-syntax-sublimelinter-gutter-mark)}div#\:\$p > svg > foreignObject > section .pl-corl{color:var(--color-prettylights-syntax-constant-other-reference-link);text-decoration:underline}div#\:\$p > svg > foreignObject > section [role=button]:focus:not(:focus-visible),div#\:\$p > svg > foreignObject > section [role=tabpanel][tabindex="0"]:focus:not(:focus-visible),div#\:\$p > svg > foreignObject > section a:focus:not(:focus-visible),div#\:\$p > svg > foreignObject > section button:focus:not(:focus-visible),div#\:\$p > svg > foreignObject > section summary:focus:not(:focus-visible){box-shadow:none;outline:none}div#\:\$p > svg > foreignObject > section [tabindex="0"]:focus:not(:focus-visible),div#\:\$p > svg > foreignObject > section details-dialog:focus:not(:focus-visible){outline:none}div#\:\$p > svg > foreignObject > section g-emoji{display:inline-block;font-family:Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:1em;font-style:normal!important;font-weight:var(--base-text-weight-normal, 400);line-height:1;min-width:1ch;vertical-align:-.075em}div#\:\$p > svg > foreignObject > section g-emoji img{height:1em;width:1em}div#\:\$p > svg > foreignObject > section .task-list-item{list-style-type:none}div#\:\$p > svg > foreignObject > section .task-list-item label{font-weight:var(--base-text-weight-normal, 400)}div#\:\$p > svg > foreignObject > section .task-list-item.enabled label{cursor:pointer}div#\:\$p > svg > foreignObject > section .task-list-item+.task-list-item{margin-top:var(--base-size-4)}div#\:\$p > svg > foreignObject > section .task-list-item .handle{display:none}div#\:\$p > svg > foreignObject > section .task-list-item-checkbox{margin:0 .2em .25em -1.4em;vertical-align:middle}div#\:\$p > svg > foreignObject > section ul:dir(rtl) .task-list-item-checkbox{margin:0 -1.6em .25em .2em}div#\:\$p > svg > foreignObject > section ol:dir(rtl) .task-list-item-checkbox{margin:0 -1.6em .25em .2em}div#\:\$p > svg > foreignObject > section .contains-task-list:focus-within .task-list-item-convert-container,div#\:\$p > svg > foreignObject > section .contains-task-list:hover .task-list-item-convert-container{display:block;height:24px;overflow:visible;width:auto;clip:auto}div#\:\$p > svg > foreignObject > section ::-webkit-calendar-picker-indicator{filter:invert(50%)}div#\:\$p > svg > foreignObject > section .markdown-alert{border-left:.25em solid var(--borderColor-default);color:inherit;margin-bottom:var(--base-size-16);padding:var(--base-size-8) var(--base-size-16)}div#\:\$p > svg > foreignObject > section .markdown-alert>:first-child{margin-top:0}div#\:\$p > svg > foreignObject > section .markdown-alert>:last-child{margin-bottom:0}div#\:\$p > svg > foreignObject > section .markdown-alert .markdown-alert-title{align-items:center;display:flex;font-weight:var(--base-text-weight-medium, 500);line-height:1}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-note{border-left-color:var(--borderColor-accent-emphasis)}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-note .markdown-alert-title{color:var(--fgColor-accent)}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-important{border-left-color:var(--borderColor-done-emphasis)}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-important .markdown-alert-title{color:var(--fgColor-done)}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-warning{border-left-color:var(--borderColor-attention-emphasis)}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-warning .markdown-alert-title{color:var(--fgColor-attention)}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-tip{border-left-color:var(--borderColor-success-emphasis)}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-tip .markdown-alert-title{color:var(--fgColor-success)}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-caution{border-left-color:var(--borderColor-danger-emphasis)}div#\:\$p > svg > foreignObject > section .markdown-alert.markdown-alert-caution .markdown-alert-title{color:var(--fgColor-danger)}div#\:\$p > svg > foreignObject > section>:first-child>.heading-element:first-child{margin-top:0!important}div#\:\$p > svg > foreignObject > section .highlight :is(pre, marp-pre):has(+.zeroclipboard-container){min-height:52px}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1){color:var(--h1-color);font-size:1.6em}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1),div#\:\$p > svg > foreignObject > section :is(h2, marp-h2){border-bottom:none}div#\:\$p > svg > foreignObject > section :is(h2, marp-h2){font-size:1.3em}div#\:\$p > svg > foreignObject > section :is(h3, marp-h3){font-size:1.1em}div#\:\$p > svg > foreignObject > section :is(h4, marp-h4){font-size:1.05em}div#\:\$p > svg > foreignObject > section :is(h5, marp-h5){font-size:1em}div#\:\$p > svg > foreignObject > section :is(h6, marp-h6){font-size:.9em}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1) strong,div#\:\$p > svg > foreignObject > section :is(h2, marp-h2) strong,div#\:\$p > svg > foreignObject > section :is(h3, marp-h3) strong,div#\:\$p > svg > foreignObject > section :is(h4, marp-h4) strong,div#\:\$p > svg > foreignObject > section :is(h5, marp-h5) strong,div#\:\$p > svg > foreignObject > section :is(h6, marp-h6) strong{color:var(--heading-strong-color);font-weight:inherit}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h2, marp-h2)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h3, marp-h3)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h4, marp-h4)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h5, marp-h5)::part(auto-scaling),div#\:\$p > svg > foreignObject > section :is(h6, marp-h6)::part(auto-scaling){max-height:563px}div#\:\$p > svg > foreignObject > section hr{height:0;padding-top:.25em}div#\:\$p > svg > foreignObject > section img{background-color:transparent}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre){border:1px solid var(--borderColor-default);line-height:1.15;overflow:visible}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre)::part(auto-scaling){max-height:529px}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs){color:var(--color-prettylights-syntax-storage-modifier-import)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-doctag),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-keyword),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-meta .hljs-keyword),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-template-tag),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-template-variable),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-type),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-variable.language_){color:var(--color-prettylights-syntax-keyword)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-title),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-title.class_),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-title.class_.inherited__),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-title.function_){color:var(--color-prettylights-syntax-entity)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-attr),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-attribute),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-literal),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-meta),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-number),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-operator),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-selector-attr),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-selector-class),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-selector-id),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-variable){color:var(--color-prettylights-syntax-constant)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-meta .hljs-string),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-regexp),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-string){color:var(--color-prettylights-syntax-string)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-built_in),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-symbol){color:var(--color-prettylights-syntax-variable)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-code),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-comment),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-formula){color:var(--color-prettylights-syntax-comment)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-name),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-quote),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-selector-pseudo),div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-selector-tag){color:var(--color-prettylights-syntax-entity-tag)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-subst){color:var(--color-prettylights-syntax-storage-modifier-import)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-section){color:var(--color-prettylights-syntax-markup-heading);font-weight:700}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-bullet){color:var(--color-prettylights-syntax-markup-list)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-emphasis){color:var(--color-prettylights-syntax-markup-italic);font-style:italic}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-strong){color:var(--color-prettylights-syntax-markup-bold);font-weight:700}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-addition){background-color:var(--color-prettylights-syntax-markup-inserted-bg);color:var(--color-prettylights-syntax-markup-inserted-text)}div#\:\$p > svg > foreignObject > section :is(pre, marp-pre) :where(.hljs-deletion){background-color:var(--color-prettylights-syntax-markup-deleted-bg);color:var(--color-prettylights-syntax-markup-deleted-text)}div#\:\$p > svg > foreignObject > section footer,div#\:\$p > svg > foreignObject > section header{color:var(--header-footer-color);font-size:18px;left:30px;margin:0;position:absolute}div#\:\$p > svg > foreignObject > section header{top:21px}div#\:\$p > svg > foreignObject > section footer{bottom:21px}div#\:\$p > svg > foreignObject > section{--h1-color:#246;--header-footer-color:hsla(0,0%,40%,.75);--heading-strong-color:#48c;--paginate-color:#777;--base-size-4:4px;--base-size-8:8px;--base-size-16:16px;--base-size-24:24px;--base-size-40:40px;align-items:stretch;display:block;flex-flow:column nowrap;font-size:29px;height:720px;padding:78.5px;place-content:safe center center;width:1280px}div#\:\$p > svg > foreignObject > section{--marpit-root-font-size:29px;}div#\:\$p > svg > foreignObject > section:where(.invert){--h1-color:#cee7ff;--header-footer-color:hsla(0,0%,60%,.75);--heading-strong-color:#7bf;--paginate-color:#999;}div#\:\$p > svg > foreignObject > section>:last-child,div#\:\$p > svg > foreignObject > section[data-footer]>:nth-last-child(2){margin-bottom:0}div#\:\$p > svg > foreignObject > section>:first-child,div#\:\$p > svg > foreignObject > section>header:first-child+*{margin-top:0}div#\:\$p > svg > foreignObject > section:after{bottom:21px;color:var(--paginate-color);font-size:24px;padding:0;position:absolute;right:30px}div#\:\$p > svg > foreignObject > section:after{--marpit-root-font-size:24px;}div#\:\$p > svg > foreignObject > section[data-color] :is(h1, marp-h1),div#\:\$p > svg > foreignObject > section[data-color] :is(h2, marp-h2),div#\:\$p > svg > foreignObject > section[data-color] :is(h3, marp-h3),div#\:\$p > svg > foreignObject > section[data-color] :is(h4, marp-h4),div#\:\$p > svg > foreignObject > section[data-color] :is(h5, marp-h5),div#\:\$p > svg > foreignObject > section[data-color] :is(h6, marp-h6){color:currentcolor}div#\:\$p > svg > foreignObject > :where(section){container-type:size}div#\:\$p > svg > foreignObject > section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}div#\:\$p > svg > foreignObject > section{background-image:url(./rubykaigi2025_bg.004.jpeg)}div#\:\$p > svg > foreignObject > section figure{background-image:url(./rubykaigi2025_bg.004.jpeg)}div#\:\$p > svg > foreignObject > section :is(h1, marp-h1){color:black;font-family:"Lexend", sans-serif;font-weight:700;font-style:normal}div#\:\$p > svg > foreignObject > section :is(h2, marp-h2){color:black;margin-top:4em;text-indent:0.3em;font-family:"Lexend", sans-serif;font-weight:800;font-style:bold}div#\:\$p > svg > foreignObject > section.title :is(h1, marp-h1){color:white;font-size:66px;text-align:center}div#\:\$p > svg > foreignObject > section.title :is(h2, marp-h2){color:white;font-family:"Lexend", sans-serif;font-weight:400;font-size:32pt;text-align:center;margin-top:1em}div#\:\$p > svg > foreignObject > section.hero0 :is(h1, marp-h1){color:white;font-size:66px;text-align:center}div#\:\$p > svg > foreignObject > section.hero1 :is(h1, marp-h1){color:white;font-size:40px;position:absolute;top:81%;left:86%}div#\:\$p > svg > foreignObject > section.hero :is(h1, marp-h1){font-size:66px;text-align:center}div#\:\$p > svg > foreignObject > section.fin blockquote{position:relative;top:-1%;font-family:"Hina Mincho", serif;font-weight:300;font-size:50px;margin-left:19%;border:none}div#\:\$p > svg > foreignObject > section.fin blockquote small{font-family:"Lexend", sans-serif;line-height:1;font-size:25px;padding-left:14.5%}div#\:\$p > svg > foreignObject > section.fin address{font-family:"Lexend", sans-serif;font-size:25px;position:absolute;top:80%;left:72%}div#\:\$p > svg > foreignObject > section:not(.title):not(.hero):not(.hero0):not(.hero1) :is(h1, marp-h1), div#\:\$p > svg > foreignObject > section.normal2 :is(h1, marp-h1){position:absolute;top:13%}div#\:\$p > svg > foreignObject > section p, div#\:\$p > svg > foreignObject > section ul{font-family:"Lexend", sans-serif;font-weight:300;font-style:normal}div#\:\$p > svg > foreignObject > section ul.lowered{position:absolute;top:65%!important}div#\:\$p > svg > foreignObject > section:not(.title):not(.hero):not(.hero0) ul{position:absolute;top:28.5%}div#\:\$p > svg > foreignObject > section ul.underpre{position:relative!important;top:2.5%!important}div#\:\$p > svg > foreignObject > section ul.underpre2{position:absolute;top:60%!important}div#\:\$p > svg > foreignObject > section:not(.title):not(.hero):not(.hero0) ul ul{position:relative}div#\:\$p > svg > foreignObject > section.sample2 :is(pre, marp-pre){position:relative;top:20%}div#\:\$p > svg > foreignObject > section.pre-with-desc :is(pre, marp-pre){position:relative;top:20%}div#\:\$p > svg > foreignObject > section li{list-style-type:none;font-size:125%;margin-left:-1em;line-height:185%}div#\:\$p > svg > foreignObject > section li::before{content:"__";color:transparent;font-size:37pt;width:45pt;position:relative;top:4.5pt;border-color:transparent;border-width:0 0 0 45.8pt;border-style:solid;margin-right:0.25em;background-color:transparent;background-image:url("./icon1-1750.png");background-size:45pt;background-repeat:no-repeat;vertical-align:middle}div#\:\$p > svg > foreignObject > section ul li li::marker{font-size:110%}div#\:\$p > svg > foreignObject > section li ul li::before{content:"";border:none;background-image:none}div#\:\$p > svg > foreignObject > section li ul li{list-style-image:none;list-style-type:"\2726";margin-left:3em;padding-top:0.15em;font-size:90%}div#\:\$p > svg > foreignObject > section li ul li ul li{list-style-image:none;list-style-type:"\2726";margin-left:0.1em;padding-top:0.15em;font-size:90%}div#\:\$p > svg > foreignObject > section.normal img{float:right;background-color:transparent;margin-top:5%}div#\:\$p > svg > foreignObject > section.profile img.me{position:absolute;top:25%;left:64%;overflow:hidden!important;border-radius:50%!important}div#\:\$p > svg > foreignObject > section.profile img.shr{vertical-align:top;position:relative;top:6px}div#\:\$p > svg > foreignObject > section::after{font-size:14pt;font-family:"Poppins", sans-serif;font-weight:200;font-style:normal}div#\:\$p > svg > foreignObject > section::after{--marpit-root-font-size: 14pt;}div#\:\$p > svg > foreignObject > section button{font-size:30pt}div#\:\$p > svg > foreignObject > section.pre-top75 :is(pre, marp-pre){margin-top:40%}div#\:\$p > svg > foreignObject > section.pre-top80 :is(pre, marp-pre){margin-top:45%}div#\:\$p > svg > foreignObject > section.pre-top5 :is(pre, marp-pre){margin-top:5%}div#\:\$p > svg > foreignObject > section.pre-top9 :is(pre, marp-pre){margin-top:9%}div#\:\$p > svg > foreignObject > section.pre-top20 :is(pre, marp-pre){position:relative;margin-top:22%}div#\:\$p > svg > foreignObject > section.pre-top30 :is(pre, marp-pre){position:relative;margin-top:32%}div#\:\$p > svg > foreignObject > section.pre-top5-2 + :is(h1, marp-h1) + :is(pre, marp-pre){margin-top:15%}div#\:\$p > svg > foreignObject > section.pre-ruby-top5 marp-pre:has(code.language-ruby){margin-top:5%}div#\:\$p > svg > foreignObject > section.pre-code-top10 marp-pre:has(code.language-lua){margin-top:13%}div#\:\$p > svg > foreignObject > section.img-front img{float:none;text-align:center}div#\:\$p > svg > foreignObject > section.two-samples table{font-size:22pt;position:relative;top:22%}div#\:\$p > svg > foreignObject > section.two-samples img{float:left;margin-top:0.2em}div#\:\$p > svg > foreignObject > section.img-top5 img{position:relative;top:8%;right:3em}div#\:\$p > svg > foreignObject > section.img-top6 img{position:relative;top:6%}div#\:\$p > svg > foreignObject > section.img-top20 img{position:relative;top:20%}div#\:\$p > svg > foreignObject > section.img-top-minus img{position:relative;top:-50%;right:2.5em}div#\:\$p > svg > foreignObject > section table{margin-top:5%;font-size:28pt}div#\:\$p > svg > foreignObject > section.table-top5 table{font-size:28pt}div#\:\$p > svg > foreignObject > section.table-top9 table{margin-top:12%;font-size:28pt}div#\:\$p > svg > foreignObject > section.table-top15 table{margin-top:17%;font-size:24pt}div#\:\$p > svg > foreignObject > section.vm-example-desc ul{font-size:22pt}div#\:\$p > svg > foreignObject > section.logos img{top:1em;position:relative;float:right}div#\:\$p > svg > foreignObject > section.logos img + img{position:relative;float:right}div#\:\$p > svg > foreignObject > section{width:1280px;height:720px}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"]{columns:initial!important;display:block!important;padding:0!important}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"]::before, div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"]::after, div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="content"]::before, div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="content"]::after{display:none!important}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"] > div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"] > div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction="vertical"]{flex-direction:column}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"][data-marpit-advanced-background-split] > div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split, 50%)}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"][data-marpit-advanced-background-split="right"] > div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"] > div[data-marpit-advanced-background-container] > figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="background"] > div[data-marpit-advanced-background-container] > figure > figcaption{position:absolute;border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;white-space:nowrap;width:1px}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="content"], div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="pseudo"]{background:transparent!important}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background="pseudo"], div#\:\$p > svg[data-marpit-svg] > foreignObject[data-marpit-advanced-background="pseudo"]{pointer-events:none!important}div#\:\$p > svg > foreignObject > section[data-marpit-advanced-background-split]{width:100%;height:100%}
</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id=":$p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="1" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.002.jpeg)" data-class="title" data-theme="rubykaigi2025" lang="ja-JP" class="title" data-marpit-pagination="1" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.002.jpeg);--class:title;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.002.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="running-rubywasmbron-pure-ruby-wasm-runtime">Running ruby.wasm<br />On Pure Ruby Wasm Runtime</h1>
<h2 id="presentation-by-uchio-kondo">Presentation by Uchio Kondo</h2>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="2" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.005.jpeg)" data-class="hero0" data-theme="rubykaigi2025" lang="ja-JP" class="hero0" data-marpit-pagination="2" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.005.jpeg);--class:hero0;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.005.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="hello-from-matz-yama">Hello from Matz-yama!</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="3" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-class="profile" data-theme="rubykaigi2025" lang="ja-JP" class="profile" data-marpit-pagination="3" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--class:profile;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9"><img class="me" width="300" src="./rk2024-me-2.png" />
<h1 id="selfintroduce">self.introduce!</h1>
<ul>
<li>Uchio Kondo
<ul>
<li>from Fukuoka.rb</li>
</ul>
</li>
<li>Member of <img class="shr" alt="SmartHR, Inc." width="250" src="./image-25.png" />
<ul>
<li>Product Engineer</li>
</ul>
</li>
<li>Translator of &quot;Learning eBPF&quot;</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="4" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:35%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;image-5.png&quot;);background-size:300px auto;"></figure></div></section></foreignObject><foreignObject width="65%" height="720"><section id="4" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="4" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:35%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1 id="translator-of-learning-ebpf">Translator of &quot;Learning eBPF&quot;</h1>
<ul>
<li>It's on sale! <strong>Visit @. bookstore!</strong></li>
<li>If you're interested in Ivo's talk,<br />BPF's also helpful (?)</li>
</ul>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="4" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="right"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.005.jpeg)" data-class="hero0" data-theme="rubykaigi2025" lang="ja-JP" class="hero0" data-marpit-pagination="5" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.005.jpeg);--class:hero0;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.005.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="todays-theme-wardite">Today's Theme: Wardite</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="6" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="whats-wardite">What's Wardite?</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="7" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wardite">Wardite?</h1>
<ul>
<li style="margin-left: -2.2em !important;">A Pure Ruby WebAssembly Runtime</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="8" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:50%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./image-wardite.png&quot;);"></figure></div></section></foreignObject><foreignObject width="50%" height="720"><section id="8" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="8" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:50%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1 id="wardite-1">Wardite?</h1>
<ul>
<li>Wardite is named<br />after the real mineral<br /><strong>WA</strong>rdite.</li>
</ul>
<address>
<br />
<br />
<br />
<br />
<br />
<br />
<br />
photo: https://en.wikipedia.org/wiki/Wardite#/media/File:Wardite.jpg 
</address>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="8" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="right"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="9" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="running-wardite">Running Wardite</h1>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>$ gem install wardite
$ wardite ./helloworld.wasm
Hello, world
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="10" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="using-wardite-as-a-gem">Using Wardite as a Gem</h1>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;wardite&#x27;</span>

instance = <span class="hljs-title class_">Wardite</span>.new(<span class="hljs-symbol">path:</span> <span class="hljs-string">&#x27;./helloworld.wasm&#x27;</span>, <span class="hljs-symbol">enable_wasi:</span> <span class="hljs-literal">true</span>)
ret = instance._start
<span class="hljs-comment">#=&gt; Output: Hello, world</span>
p ret
<span class="hljs-comment">#=&gt; I32(0)</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="11" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="11" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="what-is-webassembly">What is WebAssembly?</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="12" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="12" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="what-is-webassembly-1">What is WebAssembly?</h1>
<ul>
<li>WebAssembly is:
<ul>
<li>A binary instruction format</li>
<li>Originally designed for execution in web browsers</li>
<li>Nowadays used in various environments including server-side</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="13" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="13" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="webassembly-runs-in-browsers">WebAssembly Runs in Browsers</h1>
<ul>
<li>You can compile C code like this into wasm and run it</li>
</ul>
<br />
<br />
<br />
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-c"><span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
    <span class="hljs-keyword">return</span> a + b;
}
</code></pre>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-javascript"><span class="hljs-title class_">WebAssembly</span>.<span class="hljs-title function_">instantiateStreaming</span>(<span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;./out.wasm&quot;</span>), {}).<span class="hljs-title function_">then</span>(
    <span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {
        <span class="hljs-keyword">let</span> answer = obj.<span class="hljs-property">instance</span>.<span class="hljs-property">exports</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">100</span>, <span class="hljs-number">200</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;debug: 100 + 200 = &quot;</span>, answer);
    }
);
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="14" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:70%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;image-19.png&quot;);background-size:800px auto;"></figure></div></section></foreignObject><foreignObject width="30%" height="720"><section id="14" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="14" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:70%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1 id="result">Result</h1>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="14" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="right"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="15" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="webassembly-execution-flow">WebAssembly Execution Flow</h1>
<ul>
<li>First, prepare source code (in C, C++, Rust...)</li>
<li>Then compile it into wasm binary</li>
<li>Finally, executing wasm binary via WebAssembly runtime</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="16" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="webassembly-execution-flow-1">WebAssembly Execution Flow</h1>
<p><img src="image-9.png" alt="" style="width:1000px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="17" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="so-what-is-wardite">So, What is Wardite?</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="18" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="18" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="so-what-is-wardite-1">So, What is Wardite?</h1>
<ul>
<li>A WebAssembly Runtime written in Pure Ruby</li>
<li>We can run WebAssembly within Ruby</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="19" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wardites-design-principles">Wardite's Design Principles</h1>
<ul>
<li>Purity:
<ul>
<li>Depends only on Ruby's standard and bundled libraries</li>
<li>No external C dependencies or third-party Ruby gems</li>
</ul>
</li>
<li>Portability:
<ul>
<li>Can run on any Ruby environment</li>
<li>Even on mruby (planned for future versions)</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="20" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wardites-implementation-status">Wardite's Implementation Status</h1>
<ul>
<li>Supports basic WebAssembly Core specifications</li>
<li>WASI Preview 1</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="21" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="21" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="webassembly-core-spec-is">WebAssembly Core Spec is...</h1>
<ul>
<li>A set of basic WebAssembly specifications
<ul>
<li>Defines WebAssembly's...
<ul>
<li>binary and text formats</li>
<li>instruction set</li>
<li>type system</li>
<li>memory model, etc.</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="22" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="22" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="and-what-is-wasi">And what is WASI?</h1>
<ul>
<li>= WebAssembly System Interface</li>
<li>The Core Spec itself doesn't define OS interactions
<ul>
<li>e.g. I/O, filesystem, clock, etc.</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="23" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="23" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wasi-picture">WASI picture</h1>
<ul>
<li>WASI defines APIs to interact with the OS</li>
</ul>
<br />
<br />
<br />
<br />
<br />
<p><img src="image-10.png" alt="" style="width:800px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="24" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="24" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="why-wardite">Why Wardite?</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="25" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="25" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wardites-goals">Wardite's Goals</h1>
<ul>
<li>#1
<ul>
<li>Expand use cases for wasm language embedding in Ruby</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="26" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="26" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wardites-goals-1">Wardite's Goals</h1>
<ul>
<li>#2
<ul>
<li>Desire to make very portable implementation</li>
<li>(works where Ruby works, or works with mruby)</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="27" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="27" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="cf-using-wasmtime-rb">c.f. Using wasmtime-rb</h1>
<ul>
<li>Or other native-based solutions...</li>
<li>On install, they require:
<ul>
<li>Native compilation or pre-compiled fat gem</li>
<li>Separate approaches for CRuby/mruby/...</li>
</ul>
</li>
<li>Wasm engine in pure Ruby provides greater maintainability</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="28" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="28" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wardites-goals-2">Wardite's Goals</h1>
<ul>
<li>#3
<ul>
<li>Helps with Ruby's performance testing
<ul>
<li>or complicated program usecase</li>
</ul>
</li>
<li>Like optcarrot?</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="29" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="29" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="but-the-real-reason-is">But the real reason is...</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="30" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.005.jpeg)" data-class="hero0" data-theme="rubykaigi2025" lang="ja-JP" class="hero0" data-marpit-pagination="30" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.005.jpeg);--class:hero0;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.005.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="just-for-fun">Just for Fun.</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="31" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="31" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="bet-webassemblys-potential">Bet WebAssembly's Potential!</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="32" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="32" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="language-agnostic-aspects">Language-Agnostic Aspects</h1>
<ul>
<li>Many compiled languages support wasm targets
<ul>
<li>Rust, Go, C/C++, Swift, Scala...</li>
<li>LLVM supporting wasm</li>
<li>And Some languages are written in C.
<ul>
<li>Ruby, Python, Lua, Perl...</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="33" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="33" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="possibilities-for-application-embedding">Possibilities for Application Embedding</h1>
<ul>
<li>The WebAssembly Core Spec seems to maintain simplicity</li>
<li>Suitability for embedded execution in applications</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="34" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="34" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="browser-as-an-embedded-environment">Browser as an Embedded Environment</h1>
<ul>
<li>Browser execution can be better understood...
<ul>
<li>As &quot;a wasm runtime embedded in the browser&quot;</li>
</ul>
</li>
</ul>
<br />
<br />
<br />
<br />
<br />
<br />
<p> <img src="image-11.png" alt="" style="width:600px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="35" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="35" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="polyglot-systems">Polyglot Systems</h1>
<ul>
<li>Language agnosticism + Embeddability
<ul>
<li>Write (wasm) component in any language</li>
<li>Combine them into an application in another language!</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="36" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="36" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="conceptual-diagram">Conceptual Diagram</h1>
<br />
<br />
<br />
<p><img src="./image-36.png" alt="" style="width:980px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="37" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="37" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="fyi-wasmcloud-concept">FYI: wasmCloud Concept</h1>
<br />
<br />
<p> <img src="image-4.png" alt="" style="height:300px;" /></p>
<ul class="underpre">
<li><a href="https://wasmcloud.com/">From wasmCloud official website</a></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="38" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="38" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wasm-is-going-beyond-the-browser">Wasm is Going Beyond the Browser</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="39" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.005.jpeg)" data-class="hero0" data-theme="rubykaigi2025" lang="ja-JP" class="hero0" data-marpit-pagination="39" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.005.jpeg);--class:hero0;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.005.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="how-to-develop-wardite">How to Develop Wardite</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="40" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="40" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="retrospective-of-past-development-milestones">Retrospective of Past Development Milestones</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="41" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="41" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wardites-development-milestones">Wardite's Development Milestones</h1>
<ul>
<li>&quot;Gorilla Book&quot; (Hello, World)</li>
<li>Core instructions</li>
<li>Running grayscale</li>
<li>Starting up ruby.wasm</li>
<li>Letting ruby.wasm require</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="42" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="42" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="gorilla-book">Gorilla Book</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="43" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="43" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="implementing-wasm-runtime-in-rust">&quot;Implementing Wasm Runtime in Rust&quot;</h1>
<ul>
<li><a href="https://zenn.dev/skanehira/books/writing-wasm-runtime-in-rust">RustWasm Runtime</a>
<ul>
<li>&quot;Gorilla Book&quot; after the author's penname</li>
</ul>
</li>
<li>A book for learning basic wasm implementation in Rust</li>
<li>Goal: Make &quot;Hello, World&quot; work</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="44" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="44" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="port-the-implementing-wasm-runtime-book">Port the &quot;Implementing Wasm Runtime&quot; Book</h1>
<ul>
<li>Understanding the overall VM design is quite challenging...
<ul>
<li>Basic VM structure and instructions</li>
<li>Memory initialization</li>
<li>Function call/import/export</li>
<li>Some support of WASI</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="45" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="45" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="book-impressions">Book Impressions</h1>
<ul>
<li>Challenging, however,
<ul>
<li>It's understandable with careful reading of the book and spec documentation</li>
</ul>
</li>
<li>Having a Rust reference implementation was very helpful!</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="46" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="46" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="task-1-binary-format">Task #1: Binary Format</h1>
<ul>
<li>A wasm binary has a specific size of sections</li>
<li>Section format:
<ul>
<li>Header, including content size at the beginning</li>
<li>Simple structure with section-specific content following</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="47" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="47" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="binary-format-overview">Binary Format Overview</h1>
<br />
<br />
<p><img src="./image-29.png" alt="" style="width:1020px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="48" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="48" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="task-2-vm-implementation">Task #2: VM Implementation</h1>
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby"><span class="hljs-keyword">def</span> <span class="hljs-title function_">execute!</span>
  loop <span class="hljs-keyword">do</span>
    cur_frame = <span class="hljs-variable language_">self</span>.call_stack.last <span class="hljs-comment">#: Frame</span>
    <span class="hljs-keyword">break</span> <span class="hljs-keyword">unless</span> cur_frame
    cur_frame.pc += <span class="hljs-number">1</span>
    insn = cur_frame.body[cur_frame.pc] <span class="hljs-comment">#: Op</span>
    <span class="hljs-keyword">break</span> <span class="hljs-keyword">unless</span> insn
    eval_insn(cur_frame, insn)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<ul class="underpre">
<li>This is almost a real Wardite code!</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="49" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="49" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="task-3-output">Task #3: &quot;Output&quot;</h1>
<ul>
<li>A common issue for programming language creator?</li>
<li>&quot;Output&quot; requires using OS functionality</li>
<li>Had to implement WASI's <code>fd_write()</code> just for &quot;output&quot;
<ul>
<li>Following the book was sufficient. Thank goodness</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="50" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:50%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;image-13.jpg&quot;);background-size:500px auto;"></figure></div></section></foreignObject><foreignObject width="50%" height="720"><section id="50" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="50" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:50%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1 id="hello-world-worked">&quot;Hello World&quot; Worked</h1>
<blockquote>
<p>@ 2024-10-28<br />
Allowing <code>fib()</code> to work, I just completed &quot;Gorilla Book&quot; basic course for now!<br />
All that's left is to thoroughly master Wasm...</p>
</blockquote>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="50" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="right"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="51" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="51" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="core-instructions">Core Instructions</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="52" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="52" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="covering-basic-core-spec-instructions">Covering Basic Core Spec Instructions</h1>
<ul>
<li>After Hello World worked, wanted to implement more</li>
<li>Goals
<ul>
<li>Cover basic Core Spec instructions</li>
<li>At this point, had the desire to &quot;make ruby.wasm work&quot;</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="53" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="53" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wasm-instruction-set">wasm Instruction Set</h1>
<ul>
<li>There are basic and extended sets</li>
<li>Basic range is written in the Core Spec</li>
<li>About extended sets
<ul>
<li>GC, atomic, reference types, simd...</li>
<li>Supporting extentions are... future work!</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="54" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:55%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;image-14.png&quot;);background-size:auto 580px;"></figure></div></section></foreignObject><foreignObject width="45%" height="720"><section id="54" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="54" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:55%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1 id="opcodes-table"><a href="https://pengowray.github.io/wasm-ops/">Opcodes Table</a></h1>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="54" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="right"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="55" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="55" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="challenges">Challenges</h1>
<ul>
<li>Implemented <strong>192</strong> instructions in total</li>
<li>Just kept working diligently</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="56" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="56" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="implement-numeric-operations">Implement Numeric Operations</h1>
<ul>
<li>Since there're 4 types, there're common ones
<ul>
<li><code>i32, i64, f32, f64</code></li>
</ul>
</li>
<li>Created a generator using <code>rake</code> task</li>
<li>There are <strong>167</strong> insns automatically generated
<ul>
<li>Note: this includes converting insns</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="57" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="57" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="automatic-generation-templates">Automatic Generation Templates</h1>
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby">  <span class="hljs-variable constant_">DEFS</span> = { <span class="hljs-comment">#: Hash[Symbol, String]</span>
    <span class="hljs-comment"># ...</span>
  
    <span class="hljs-symbol">add:</span> <span class="hljs-string">&lt;&lt;~RUBY,
      when :${PREFIX}_add
        right, left = runtime.stack.pop, runtime.stack.pop
        if !right.is_a?(${CLASS}) || !left.is_a?(${CLASS})
          raise EvalError, &quot;maybe empty or invalid stack&quot;
        end
        runtime.stack.push(${CLASS}(left.value + right.value))
    RUBY</span>
    <span class="hljs-comment"># ...</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="58" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="58" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="generated-codes">Generated Codes</h1>
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby"><span class="hljs-keyword">module</span> <span class="hljs-title class_">Wardite</span>
  <span class="hljs-keyword">module</span> <span class="hljs-title class_">Evaluator</span>
    <span class="hljs-comment"># <span class="hljs-doctag">@rbs</span> ...</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">self</span>.i32_eval_insn(runtime, frame, insn)
      <span class="hljs-keyword">case</span> insn.code
      <span class="hljs-comment"># ...</span>
      <span class="hljs-keyword">when</span> <span class="hljs-symbol">:i32_add</span>
        right, left = runtime.stack.pop, runtime.stack.pop
        <span class="hljs-keyword">if</span> !right.is_a?(<span class="hljs-variable constant_">I32</span>) |<span class="hljs-params"></span>| !left.is_a?(<span class="hljs-variable constant_">I32</span>)
          <span class="hljs-keyword">raise</span> <span class="hljs-title class_">EvalError</span>, <span class="hljs-string">&quot;maybe empty or invalid stack&quot;</span>
        <span class="hljs-keyword">end</span>
        runtime.stack.push(<span class="hljs-variable constant_">I32</span>(left.value + right.value))

      <span class="hljs-comment"># ...</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="59" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="59" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="grayscale-journey">Grayscale Journey</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="60" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="60" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="running-sample-programs">Running Sample Programs</h1>
<ul>
<li>With instructions implemented, moved to practical testing</li>
<li>Tried running a grayscale processing program
<ul>
<li>Made in Rust from another personal project</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="61" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="61" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="it-didnt-work">It Didn't Work...</h1>
<p><img src="image-17.png" alt="alt text" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="62" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="62" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="lets-start-debugging">Let's start debugging</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="63" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="63" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="overview-of-the-grayscale-program">Overview of the Grayscale Program</h1>
<br />
<p><img src="image-15.png" alt="" style="width:950px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="64" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="64" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="fixing-memory-allocation-memorygrow">Fixing Memory Allocation (memory.grow)</h1>
<ul>
<li>Found memory allocation wasn't working correctly</li>
<li>The fix was <a href="https://github.com/udzura/wardite/commit/ecd64f25856c99c12a644efac4becb2573021e45">just one line</a>, but took quite some effort
<ul>
<li>Note: tracing wasm binary in browser debugger was efficient</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="65" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="65" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="fix-commit">Fix Commit</h1>
<p><img src="image-18.png" alt="alt text" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="66" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="66" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="but-it-still-didnt-work">But It Still Didn't Work</h1>
<ul>
<li>Rust's panic was converted to <code>unreachable</code>...
<ul>
<li><code>unreachable</code> = a wasm instruction meaning &quot;this point should never be reached, error if reached&quot;</li>
</ul>
</li>
<li>Modified it to return error strings instead of panicking</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="67" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="67" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="error-string">Error String</h1>
<ul>
<li>Content:
<blockquote>
<p><code>Format error decoding Png: Corrupt deflate stream. DistanceTooFarBack</code></p>
</blockquote>
</li>
<li><a href="https://github.com/image-rs/fdeflate/blob/4610c916ae1000c9b5839059340598a7c55130e8/src/decompress.rs#L42">Looking at the Rust implementation</a></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="68" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="68" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<p><img src="image-6.png" alt="" style="height:460px;" /></p>
<ul class="underpre">
<li>Hmm, not sure what's going on</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="69" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="69" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="what-its-doing">What It's Doing</h1>
<ul>
<li>On decoding PNG</li>
<li>Decompressing deflate compression</li>
<li>Have to study the deflate algorithm from scratch? <img class="emoji" draggable="false" alt="" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f635-200d-1f4ab.svg" data-marp-twemoji=""/></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="70" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="70" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="correctly-handling-deflate">Correctly Handling Deflate...?</h1>
<ul>
<li>Looking at the inflate/deflate processing
<ul>
<li>it's clear that <strong>bit shift operations</strong> are heavily used</li>
</ul>
</li>
<li>Maybe one of the related insns isn't working correctly?</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="71" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="71" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="verifying-i32-instruction-correctness">Verifying i32 Instruction Correctness</h1>
<ul>
<li>There're <a href="https://github.com/WebAssembly/spec/tree/main/test/core">official wasm core spec test cases</a> !</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="72" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="72" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="running-the-test-cases">Running the Test Cases</h1>
<ul>
<li>The official test suite provides <code>wast</code> format files</li>
<li>Using a command called <code>wast2json</code>
<ul>
<li>Can generate JSON files and Wasm binaries</li>
<li>Run tests from these testcase files</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="73" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="73" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="flow-diagram">Flow Diagram:</h1>
<p><img src="./image-37.png" alt="" style="height:520px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="74" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="74" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby">testcase = <span class="hljs-variable constant_">JSON</span>.load_file(<span class="hljs-string">&quot;spec/i32.json&quot;</span>, <span class="hljs-symbol">symbolize_names:</span> <span class="hljs-literal">true</span>)
testcase[<span class="hljs-symbol">:commands</span>].each <span class="hljs-keyword">do</span> |<span class="hljs-params">command</span>|
  <span class="hljs-keyword">case</span> command[<span class="hljs-symbol">:type</span>]
  <span class="hljs-keyword">when</span> <span class="hljs-string">&quot;module&quot;</span>
    command =&gt; {<span class="hljs-symbol">filename:</span>}
    current = filename
  <span class="hljs-keyword">when</span> <span class="hljs-string">&quot;assert_return&quot;</span>
    command =&gt; {<span class="hljs-symbol">line:</span>, <span class="hljs-symbol">action:</span>, <span class="hljs-symbol">expected:</span>}
    action =&gt; {<span class="hljs-symbol">type:</span>, <span class="hljs-symbol">field:</span>, <span class="hljs-symbol">args:</span>}
    args_ = args.map{|<span class="hljs-params">v</span>| parse_value(v) } 
    expected_ = expected.map{|<span class="hljs-params">v</span>| parse_result(v) }
    result = <span class="hljs-title class_">Wardite</span>.new(<span class="hljs-symbol">path:</span> <span class="hljs-string">&quot;spec/&quot;</span> + current).runtime.call(field, args_)
    <span class="hljs-keyword">if</span> result != expected_[<span class="hljs-number">0</span>]
      warn <span class="hljs-string">&quot;test failed! expect: <span class="hljs-subst">#{expected_}</span> got: <span class="hljs-subst">#{ret}</span>&quot;</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="75" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="75" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="then-fix-one-by-one">Then Fix One by One</h1>
<ul>
<li>Indeed, bit shift instructions were failing, so fixed those</li>
<li>Normal cases now pass (omitted some exeption tests)</li>
</ul>
<br />
<br />
<br />
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>$ bundle exec ruby spec/runner.rb
...
Finished in 0.272498 seconds.
-------------------------------------------------------------------------------------------
442 tests, 368 assertions, 0 failures, 0 errors, 0 pendings, 83 omissions, 0 notifications
100% passed
-------------------------------------------------------------------------------------------
1622.03 tests/s, 1350.47 assertions/s
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="76" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="76" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="grayscale-worked">Grayscale Worked!</h1>
<ul>
<li>Grayscale execution result looks OK</li>
</ul>
<br />
<br />
<br />
<br />
<br />
<p><img src="image-30.png" alt="" style="height:400px;" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="77" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="77" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="want-to-run-something-more--practical">Want to Run Something More (?) Practical</h1>
<ul>
<li>Finally, started the challenge of running ruby.wasm</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="78" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="78" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="running-rubywasm">Running ruby.wasm</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="79" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="79" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="running-rubywasm-1">Running ruby.wasm</h1>
<ul>
<li>Passing ruby.wasm to <code>wardite</code> command successfully</li>
<li>Besides instruction coverage:
<ul>
<li>WASI support is needed for ruby.wasm to work</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="80" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="80" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="what-wasi-functions-does-rubywasm-need">What WASI Functions Does ruby.wasm Need?</h1>
<ul>
<li>This time, <strong>37</strong> functions are needed.
<ul>
<li>Depending on bundled gems or build env</li>
</ul>
</li>
<li>Note: Checked with this command:</li>
</ul>
<br />
<br />
<br />
<br />
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>$ wasm-objdump -x -j Import ./ruby-wasm32-wasi/usr/local/bin/ruby
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="81" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="81" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wasi-functions-imported">WASI Functions Imported...</h1>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>Import[37]:
 - func[0] sig=1 &lt;__imported_wasi_snapshot_preview1_args_get&gt; &lt;- wasi_snapshot_preview1.args_get
 - func[1] sig=1 &lt;__imported_wasi_snapshot_preview1_args_sizes_get&gt; &lt;- wasi_snapshot_preview1.args_sizes_get
 - func[2] sig=1 &lt;__imported_wasi_snapshot_preview1_environ_get&gt; &lt;- wasi_snapshot_preview1.environ_get
 - func[3] sig=1 &lt;__imported_wasi_snapshot_preview1_environ_sizes_get&gt; &lt;- wasi_snapshot_preview1.environ_sizes_get
 - func[4] sig=1 &lt;__imported_wasi_snapshot_preview1_clock_res_get&gt; &lt;- wasi_snapshot_preview1.clock_res_get
 - func[5] sig=37 &lt;__imported_wasi_snapshot_preview1_clock_time_get&gt; &lt;- wasi_snapshot_preview1.clock_time_get
 - func[6] sig=38 &lt;__imported_wasi_snapshot_preview1_fd_advise&gt; &lt;- wasi_snapshot_preview1.fd_advise
 - func[7] sig=2 &lt;__imported_wasi_snapshot_preview1_fd_close&gt; &lt;- wasi_snapshot_preview1.fd_close
 - func[8] sig=2 &lt;__imported_wasi_snapshot_preview1_fd_datasync&gt; &lt;- wasi_snapshot_preview1.fd_datasync
 - func[9] sig=1 &lt;__imported_wasi_snapshot_preview1_fd_fdstat_get&gt; &lt;- wasi_snapshot_preview1.fd_fdstat_get
 - func[10] sig=1 &lt;__imported_wasi_snapshot_preview1_fd_fdstat_set_flags&gt; &lt;- wasi_snapshot_preview1.fd_fdstat_set_flags
 - func[11] sig=1 &lt;__imported_wasi_snapshot_preview1_fd_filestat_get&gt; &lt;- wasi_snapshot_preview1.fd_filestat_get
 - func[12] sig=26 &lt;__imported_wasi_snapshot_preview1_fd_filestat_set_size&gt; &lt;- wasi_snapshot_preview1.fd_filestat_set_size
 - func[13] sig=27 &lt;__imported_wasi_snapshot_preview1_fd_pread&gt; &lt;- wasi_snapshot_preview1.fd_pread
 - func[14] sig=1 &lt;__imported_wasi_snapshot_preview1_fd_prestat_get&gt; &lt;- wasi_snapshot_preview1.fd_prestat_get
 - func[15] sig=0 &lt;__imported_wasi_snapshot_preview1_fd_prestat_dir_name&gt; &lt;- wasi_snapshot_preview1.fd_prestat_dir_name
 - func[16] sig=27 &lt;__imported_wasi_snapshot_preview1_fd_pwrite&gt; &lt;- wasi_snapshot_preview1.fd_pwrite
 - func[17] sig=3 &lt;__imported_wasi_snapshot_preview1_fd_read&gt; &lt;- wasi_snapshot_preview1.fd_read
 - func[18] sig=27 &lt;__imported_wasi_snapshot_preview1_fd_readdir&gt; &lt;- wasi_snapshot_preview1.fd_readdir
 - func[19] sig=1 &lt;__imported_wasi_snapshot_preview1_fd_renumber&gt; &lt;- wasi_snapshot_preview1.fd_renumber
 - func[20] sig=45 &lt;__imported_wasi_snapshot_preview1_fd_seek&gt; &lt;- wasi_snapshot_preview1.fd_seek
 - func[21] sig=2 &lt;__imported_wasi_snapshot_preview1_fd_sync&gt; &lt;- wasi_snapshot_preview1.fd_sync
 - func[22] sig=1 &lt;__imported_wasi_snapshot_preview1_fd_tell&gt; &lt;- wasi_snapshot_preview1.fd_tell
 - func[23] sig=3 &lt;__imported_wasi_snapshot_preview1_fd_write&gt; &lt;- wasi_snapshot_preview1.fd_write
 - func[24] sig=0 &lt;__imported_wasi_snapshot_preview1_path_create_directory&gt; &lt;- wasi_snapshot_preview1.path_create_directory
 - func[25] sig=5 &lt;__imported_wasi_snapshot_preview1_path_filestat_get&gt; &lt;- wasi_snapshot_preview1.path_filestat_get
 - func[26] sig=64 &lt;__imported_wasi_snapshot_preview1_path_filestat_set_times&gt; &lt;- wasi_snapshot_preview1.path_filestat_set_times
 - func[27] sig=13 &lt;__imported_wasi_snapshot_preview1_path_link&gt; &lt;- wasi_snapshot_preview1.path_link
 - func[28] sig=65 &lt;__imported_wasi_snapshot_preview1_path_open&gt; &lt;- wasi_snapshot_preview1.path_open
 - func[29] sig=9 &lt;__imported_wasi_snapshot_preview1_path_readlink&gt; &lt;- wasi_snapshot_preview1.path_readlink
 - func[30] sig=0 &lt;__imported_wasi_snapshot_preview1_path_remove_directory&gt; &lt;- wasi_snapshot_preview1.path_remove_directory
 - func[31] sig=9 &lt;__imported_wasi_snapshot_preview1_path_rename&gt; &lt;- wasi_snapshot_preview1.path_rename
 - func[32] sig=5 &lt;__imported_wasi_snapshot_preview1_path_symlink&gt; &lt;- wasi_snapshot_preview1.path_symlink
 - func[33] sig=0 &lt;__imported_wasi_snapshot_preview1_path_unlink_file&gt; &lt;- wasi_snapshot_preview1.path_unlink_file
 - func[34] sig=3 &lt;__imported_wasi_snapshot_preview1_poll_oneoff&gt; &lt;- wasi_snapshot_preview1.poll_oneoff
 - func[35] sig=4 &lt;__imported_wasi_snapshot_preview1_proc_exit&gt; &lt;- wasi_snapshot_preview1.proc_exit
 - func[36] sig=1 &lt;__imported_wasi_snapshot_preview1_random_get&gt; &lt;- wasi_snapshot_preview1.random_get
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="82" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="82" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="introduce-warditewasisnapshotpreview1">Introduce <code>Wardite::WasiSnapshotPreview1</code></h1>
<ul>
<li>Implement everything in a class called
<ul>
<li><code>Wardite::WasiSnapshotPreview1</code></li>
</ul>
</li>
<li>This class is treated specially during import</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="83" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="83" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby"><span class="hljs-keyword">module</span> <span class="hljs-title class_">Wardite</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">WasiSnapshotPreview1</span>
    <span class="hljs-comment"># <span class="hljs-doctag">@rbs</span> store: Store</span>
    <span class="hljs-comment"># <span class="hljs-doctag">@rbs</span> args: Array[wasmValue]</span>
    <span class="hljs-comment"># <span class="hljs-doctag">@rbs</span> return: Object</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">clock_time_get</span>(<span class="hljs-params">store, args</span>)
      clock_id = args[<span class="hljs-number">0</span>].value
      _precision = args[<span class="hljs-number">1</span>].value
      timebuf64 = args[<span class="hljs-number">2</span>].value
      <span class="hljs-keyword">if</span> clock_id != <span class="hljs-number">0</span> <span class="hljs-comment"># - CLOCKID_REALTIME</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Wasi</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:EINVAL</span>
      <span class="hljs-keyword">end</span>
      now = <span class="hljs-title class_">Time</span>.now.to_i * <span class="hljs-number">1_000_000</span>
      memory = store.memories[<span class="hljs-number">0</span>]
      now_packed = [now].pack(<span class="hljs-string">&quot;Q!&quot;</span>)
      memory.data[timebuf64...(timebuf64+<span class="hljs-number">8</span>)] = now_packed
      <span class="hljs-number">0</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="84" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="84" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="basic-strategy">Basic Strategy</h1>
<ul>
<li><code>loop do</code>
<ul>
<li>Try to start ruby.wasm</li>
<li>Get &quot;<code>**** function not found!</code>&quot; error</li>
<li>Implement that function</li>
</ul>
</li>
<li><code>end</code></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="85" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="85" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="examples-of-functions-implemented">Examples of Functions Implemented</h1>
<ul>
<li>Getting <code>ARGV</code>, environment variables</li>
<li>Getting current time</li>
<li>Getting random numbers</li>
<li>read/write, other functions to get various info from <code>fd</code></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="86" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="86" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="rubywasms---version-now-works">ruby.wasm's <code>--version</code> Now Works!</h1>
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>$ bundle exec wardite ./ruby -- --version        
ruby 3.4.2 (2025-02-15 revision d2930f8e7a) +PRISM [wasm32-wasi]
</code></pre>
<br />
<ul class="underpre">
<li>Released this version as Wardite 0.6.0</li>
<li><a href="https://github.com/udzura/wardite/blob/7ef48389415df9e44784d515f3e0e96aa00f2ad2/lib/wardite/wasi.rb">Code at that point</a></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="87" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="87" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="behavior-at-this-point">Behavior at This Point</h1>
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>$ bundle exec wardite ./ruby -- -e '5.times { p &quot;hello: #{_1}&quot; }'
`RubyGems' were not loaded.
`error_highlight' was not loaded.
`did_you_mean' was not loaded.
`syntax_suggest' was not loaded.
&quot;hello: 0&quot;
&quot;hello: 1&quot;
&quot;hello: 2&quot;
&quot;hello: 3&quot;
&quot;hello: 4&quot;
</code></pre>
<ul class="underpre">
<li>Ruby's C implementation core library works</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="88" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="88" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="behavior-at-this-point-2">Behavior at This Point #2</h1>
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>$ bundle exec wardite ./ruby -- -e 'puts &quot;Hello&quot;'        
`RubyGems' were not loaded.
`error_highlight' were not loaded.
`did_you_mean' were not loaded.
`syntax_suggest' were not loaded.
Hello
</code></pre>
<ul class="underpre">
<li>Cannot recognize file system</li>
<li>Cannot require, of course - load warnings at startup</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="89" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="89" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="required-work-to-solvebrrequire-issues">Required Work to Solve<br /><code>require</code> Issues</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="90" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="90" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="how-to-make-kernelrequire-work">How to Make <code>Kernel#require</code> Work</h1>
<ul>
<li>For that...
<ul>
<li>Need to make Wardite properly recognize the file system</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="91" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="91" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="initial-file-system-implementation">Initial File System Implementation</h1>
<ul>
<li>Start with opening files
<ul>
<li>Tried implementing <code>path_open</code> function roughly.</li>
<li>But not even being called?</li>
</ul>
</li>
<li>Why?</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="92" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="92" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="pre-opens-mechanism">&quot;Pre-opens&quot; Mechanism</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="93" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="93" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wasi-has-a-mechanism-called-pre-opens">WASI Has a Mechanism Called pre-opens</h1>
<ul>
<li>Many WASI runtimes, by default:
<ul>
<li>They <strong>cannot</strong> access the host's file system at all.</li>
</ul>
</li>
<li>We have to pre-open host directries to share
<ul>
<li>And register them to the process on startup</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="94" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./image-39.png&quot;);background-size:1240px auto;"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="94" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="94" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content"></section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="94" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="95" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="95" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="implementation">Implementation</h1>
<ul>
<li>Let's inspect codes in wasi-sdk's<br /><a href="https://github.com/WebAssembly/wasi-libc/blob/e9524a0980b9bb6bb92e87a41ed1055bdda5bb86/libc-bottom-half/sources/preopens.c#L246-L276"><code>libc-bottom-half/sources/preopens.c</code></a></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="96" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="96" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<p><img src="image-31.png" alt="alt text" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="97" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="97" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<p><img src="image-32.png" alt="alt text" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="98" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="98" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="inside-path_open">Inside <code>path_open()</code></h1>
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-c">    <span class="hljs-comment">// libc-bottom-half/sources/preopens.c#L190-L213</span>
    <span class="hljs-type">int</span> fd = <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = num_preopens; i &gt; <span class="hljs-number">0</span>; --i) {
        <span class="hljs-type">const</span> preopen *pre = &amp;preopens[i - <span class="hljs-number">1</span>];
        <span class="hljs-type">const</span> <span class="hljs-type">char</span> *prefix = pre-&gt;prefix;
        <span class="hljs-type">size_t</span> len = <span class="hljs-built_in">strlen</span>(prefix);

        <span class="hljs-comment">// If we haven&#x27;t had a match yet, or the candidate path is longer than</span>
        <span class="hljs-comment">// our current best match&#x27;s path, and the candidate path is a prefix of</span>
        <span class="hljs-comment">// the requested path, take that as the new best path.</span>
        <span class="hljs-keyword">if</span> ((fd == <span class="hljs-number">-1</span> || len &gt; match_len) &amp;&amp;
            prefix_matches(prefix, len, path))
        {
            fd = pre-&gt;fd;
            match_len = len;
            *abs_prefix = prefix;
        }
    }
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="99" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="99" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="so-fixed-the-prestat-functions">So Fixed the prestat Functions</h1>
<ul>
<li>Implemented properly:
<ul>
<li><code>fd_prestat_get()</code></li>
<li><code>fd_prestat_dir_name()</code></li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="100" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="100" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="ruby-started-without-load-warnings">Ruby Started Without Load Warnings</h1>
<ul>
<li>All's well that ends well</li>
</ul>
<br />
<br />
<br />
<p><img src="./image-27.png" alt="alt text" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="101" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="101" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<p><img src="./image-28.png" alt="alt text" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="102" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="102" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="its-taking-quite-some-time">...It's Taking Quite Some Time...</h1>
<ul>
<li>Initializing all of RubyGems takes 60 ~ 70 seconds</li>
<li>Let's talk about performance at the end</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="103" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.005.jpeg)" data-class="hero0" data-theme="rubykaigi2025" lang="ja-JP" class="hero0" data-marpit-pagination="103" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.005.jpeg);--class:hero0;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.005.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="performance-and-measurement">Performance and Measurement</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="104" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="104" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="dealing-with-performance-measurement">Dealing with Performance Measurement</h1>
<ul>
<li>Still halfway there!</li>
<li>Let me talk about some implemented improvements
<ul>
<li>or future plans.</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="105" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="105" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="topics">Topics</h1>
<ul>
<li>Block jump improvements</li>
<li>Instance creation issues</li>
<li>YJIT effects</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="106" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="106" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="measurement-assumptions">Measurement Assumptions</h1>
<ul>
<li>Use grayscale wasm program (basically)</li>
<li>Software versions etc.
<ul>
<li>macOS 15.3.2 / Apple M3 Pro</li>
<li>ruby 3.4.2 +YJIT +PRISM [arm64-darwin24]</li>
<li>Wardite 0.6.1</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="107" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="107" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="block-jump-improvements">Block Jump Improvements</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="108" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="108" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="background-about-jump-instructions">Background: About Jump Instructions</h1>
<ul>
<li>WebAssembly's jump insns: <code>if, block, loop</code>
<ul>
<li>Unlike common jump instructions, they don't hold offsets themselves as an operand</li>
<li>These instructions need to pick the position of their corresponding end</li>
<li>This was done in <code>fetch_ops_while_end</code></li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="109" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="109" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<p><img src="image-16.png" alt="alt text" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="110" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="110" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="when-measuring-the-first-version-with-ruby-prof">When measuring the first version with ruby-prof</h1>
<ul>
<li>Clearly, the <code>fetch_ops_while_end</code> method took some time</li>
</ul>
<br />
<br />
<br />
<p><img src="image-33.png" alt="alt text" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="111" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="111" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="use-the-cache">Use the Cache</h1>
<ul>
<li><strong>Cache end positions</strong> in instruction metadata</li>
<li>Once instructions are parsed:
<ul>
<li>revisit the instruction sequence</li>
<li>calc end positon</li>
<li>then cache it on-memory</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="112" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="112" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">revisit!</span>
      <span class="hljs-variable">@ops</span>.each_with_index <span class="hljs-keyword">do</span> |<span class="hljs-params">op, idx</span>|
        <span class="hljs-keyword">case</span> op.code
        <span class="hljs-keyword">when</span> <span class="hljs-symbol">:block</span>, <span class="hljs-symbol">:loop</span>
          next_pc = fetch_ops_while_end(idx)
          op.meta[<span class="hljs-symbol">:end_pos</span>] = next_pc
  
        <span class="hljs-keyword">when</span> <span class="hljs-symbol">:if</span>
          next_pc = fetch_ops_while_end(idx)
          else_pc = fetch_ops_while_else_or_end(idx)
          op.meta[<span class="hljs-symbol">:end_pos</span>] = next_pc
          op.meta[<span class="hljs-symbol">:else_pos</span>] = else_pc
        <span class="hljs-keyword">end</span>
      <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="113" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:45%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;image-23.png&quot;);background-size:auto 500px;"></figure></div></section></foreignObject><foreignObject width="55%" height="720"><section id="113" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="113" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:45%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1 id="reduce-time-by-43">Reduce Time by 43%</h1>

<ul>
<li>PR: <a href="https://github.com/udzura/wardite/pull/1">Cache end position #1</a></li>
<li>Used grayscale program</li>
</ul>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="113" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="right"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="114" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="114" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="instance-creation-issues">Instance Creation Issues</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="115" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="115" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="instance-creation-issues-1">Instance Creation Issues</h1>
<ul>
<li>Next, measured Wardite's bottlenecks with perf...</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="116" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="116" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="examine-perf-results">Examine Perf Results</h1>
<ul>
<li>Common occurrences were:
<ul>
<li><code>rb_vm_set_ivar_id</code></li>
<li><code>rb_class_new_instance_pass_kw</code></li>
</ul>
</li>
<li>Note: These appear at the top even with YJIT enabled</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="117" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="117" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<p><img src="./image-34.png" alt="alt" /></p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="118" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="118" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="in-other-words">In Other Words</h1>
<ul>
<li>Creating too many instances is slow</li>
<li>Wardite's internal Value implementation looks like this</li>
</ul>
<br />
<br />
<br />
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby"><span class="hljs-keyword">class</span> <span class="hljs-title class_">I32</span>
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">value</span>)
    <span class="hljs-variable">@value</span> = value
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="119" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="119" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="how-many-are-actually-being-created">How Many Are Actually Being Created?</h1>
<ul>
<li>Measured Wardite's internal Value-making functions:</li>
</ul>
<br />
<br />
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby"><span class="hljs-variable">$COUNTER</span> = {}
<span class="hljs-title class_">TracePoint</span>.trace(<span class="hljs-symbol">:call</span>) <span class="hljs-keyword">do</span> |<span class="hljs-params">tp</span>|
  <span class="hljs-keyword">if</span> %i(<span class="hljs-variable constant_">I32</span> <span class="hljs-variable constant_">I64</span> <span class="hljs-variable constant_">F32</span> <span class="hljs-variable constant_">F64</span>).<span class="hljs-keyword">include</span>?(tp.method_id)
    <span class="hljs-variable">$COUNTER</span>[tp.method_id] |<span class="hljs-params"></span>|= <span class="hljs-number">0</span>
    <span class="hljs-variable">$COUNTER</span>[tp.method_id] += <span class="hljs-number">1</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-variable constant_">END</span> {
  pp <span class="hljs-variable">$COUNTER</span>
}
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="120" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="120" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="for-example-grayscale-processing">For Example, Grayscale Processing</h1>
<br />
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>{:I32=&gt;18845604, :I64=&gt;1710552, :F32=&gt;247500}
</code></pre>
<ul>
<li>In case of I32, 18.8 million instances are being created
<ul>
<li>w/ grayscale processing</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="121" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="121" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="thoughts">Thoughts</h1>
<ul>
<li>Hypothesis:
<ul>
<li>there might be many instances of specific values?</li>
<li>For example, <code>-1, 0, 1, 2, 3, 4, 8, 16</code> ... ?</li>
</ul>
</li>
<li>Let's try memoization</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="122" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="122" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<pre is="marp-pre" data-auto-scaling="downscale-only"><code class="language-ruby"><span class="hljs-keyword">class</span> <span class="hljs-title class_">I32</span>
  (<span class="hljs-number">0</span>..<span class="hljs-number">64</span>).each <span class="hljs-keyword">do</span> |<span class="hljs-params">value</span>|
    <span class="hljs-variable">@@i32_object_pool</span>[value] = <span class="hljs-title class_">I32</span>.new(value)
  <span class="hljs-keyword">end</span>
  value = -<span class="hljs-number">1</span> &amp; <span class="hljs-variable constant_">I32</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:I32_MAX</span>
  <span class="hljs-variable">@@i32_object_pool</span>[value] = <span class="hljs-title class_">I32</span>.new(value)

  <span class="hljs-keyword">def</span> <span class="hljs-title function_">self</span>.cached_or_initialize(value)
    <span class="hljs-variable">@@i32_object_pool</span>[value] |<span class="hljs-params"></span>| <span class="hljs-title class_">I32</span>.new(value)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="123" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:45%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;image-22.png&quot;);background-size:auto 500px;"></figure></div></section></foreignObject><foreignObject width="55%" height="720"><section id="123" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="123" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:45%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1 id="results">Results</h1>

<ul>
<li>Good to some extent</li>
<li><a href="https://github.com/udzura/wardite/commit/e5b8f3ada850791d2170823d8a33c73362b62ec2">Commit <code>e5b8f3a</code></a>
<ul>
<li><a href="https://github.com/udzura/wardite/commit/">With remove tap <code>16ef6b5</code></a></li>
</ul>
</li>
<li>Note: Ruby 3.3 w/YJIT</li>
</ul>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="123" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="right"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="124" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="124" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="future-challenges">Future Challenges</h1>
<ul>
<li>TODO:
<ul>
<li>Try eliminating whole instance creation in value assignment...</li>
<li>This requires a fundamental change in the design</li>
</ul>
</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="125" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="125" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="further-tuning">Further Tuning?</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="126" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="126" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="inspection">Inspection</h1>
<ul>
<li>Breakdown of ruby.wasm bootstrap via Wardite</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="127" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:50%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;image-24.png&quot;);background-size:auto 500px;"></figure></div></section></foreignObject><foreignObject width="50%" height="720"><section id="127" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="127" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:50%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1 id="execution-overview">Execution Overview</h1>
<ul>
<li>Over half is loading</li>
<li>Sample:</li>
</ul>
<br />
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>$ ruby.wasm --version
</code></pre>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="127" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="right"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="128" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="128" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="btw-measured-wasi-function-calls">BTW: Measured WASI function calls</h1>
<ul>
<li>Sample: <code>ruby.wasm -e 'puts &quot;Hello, World&quot;'</code></li>
<li>Seems to be less controlling</li>
</ul>
<br />
<br />
<br />
<br />
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>total process done: 69.89s
load_from_buffer: 6.05s
external call count: 1049
external call elapsed: 0.0611s (0.087% ... )
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="129" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="hero" data-theme="rubykaigi2025" lang="ja-JP" class="hero" data-marpit-pagination="129" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:hero;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="yjit-yjit-yjit">YJIT, YJIT, YJIT!</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="130" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="130" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="yjit-effects">YJIT Effects</h1>
<ul>
<li>YJIT has a significant effect on Wardite's execution speed</li>
<li>Just putting the results here for reference
<ul>
<li>All environments are aarch64</li>
</ul>
</li>
<li>Sample: <code>ruby.wasm --version</code></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="131" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:80%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;image-21.png&quot;);background-size:900px auto;"></figure></div></section></foreignObject><foreignObject width="20%" height="720"><section id="131" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="131" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;--marpit-advanced-background-split:80%;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1 id="results-1">Results</h1>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="131" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo" data-marpit-advanced-background-split="right"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="132" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.005.jpeg)" data-class="hero0" data-theme="rubykaigi2025" lang="ja-JP" class="hero0" data-marpit-pagination="132" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.005.jpeg);--class:hero0;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.005.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="demonstration">Demonstration</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="133" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="133" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="lets-demo-the-startup-here">Let's Demo the Startup Here</h1>
<ul>
<li>Please let me use <code>--disable-gems</code> for speed</li>
</ul>
<pre is="marp-pre" data-auto-scaling="downscale-only"><code>$ bundle exec wardite \
    --mapdir ./ruby-wasm32-wasi/:/ ./ruby -- \
    --disable-gems -e '5.times { p &quot;hello: #{_1}&quot; }'
</code></pre>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="134" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.005.jpeg)" data-class="hero0" data-theme="rubykaigi2025" lang="ja-JP" class="hero0" data-marpit-pagination="134" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.005.jpeg);--class:hero0;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.005.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="conclusion">Conclusion</h1>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="135" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="135" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wardites-future">Wardite's Future</h1>
<ul>
<li>Improve Core Spec coverage</li>
<li>Overall refactoring</li>
<li>Performance improvements</li>
<li>Improve WASI coverage</li>
<li>Component model support ...</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="136" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="136" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="wardites-future-1">Wardite's Future</h1>
<ul>
<li>Improve Core Spec coverage</li>
<li>Overall refactoring</li>
<li>Performance improvements</li>
<li>Improve WASI coverage</li>
<li><strong>Component model support ...</strong></li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="137" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="137" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="looking-for-people-interested-in-wasm-runtime">Looking for People Interested in Wasm Runtime</h1>
<ul>
<li>First, please try using it, even just for fun</li>
<li>Thank you for your attention!</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="138" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="138" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9">
<h1 id="acknowledgements">Acknowledgements</h1>
<ul>
<li><a href="https://x.com/kateinoigakukun">@kateinoigakukun</a> for general advice</li>
<li>Colleagues at SmartHR for support</li>
<li>Fukuoka.rb</li>
<li>My Family</li>
</ul>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="139" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.003.jpeg)" data-class="fin" data-theme="rubykaigi2025" lang="ja-JP" class="fin" data-marpit-pagination="139" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.003.jpeg);--class:fin;--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.003.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9"><blockquote>
<br />
&nbsp;<small><small>... A Haiku from Masaoka Shiki</small></small>
</blockquote>
<address>
<small>See you in last day drinkups!</small>
</address>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="140" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;./rubykaigi2025_bg.001.jpeg&quot;);"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="140" data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="140" style="--paginate:true;--background-image:url(./rubykaigi2025_bg.004.jpeg);--theme:rubykaigi2025;background-image:url(./rubykaigi2025_bg.004.jpeg);background-position:center;background-repeat:no-repeat;background-size:cover;" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="content"></section>
<script>!function(){"use strict";const t={h1:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"1"},style:"display: block; font-size: 2em; margin-block-start: 0.67em; margin-block-end: 0.67em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h2:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"2"},style:"display: block; font-size: 1.5em; margin-block-start: 0.83em; margin-block-end: 0.83em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h3:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"3"},style:"display: block; font-size: 1.17em; margin-block-start: 1em; margin-block-end: 1em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h4:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"4"},style:"display: block; margin-block-start: 1.33em; margin-block-end: 1.33em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h5:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"5"},style:"display: block; font-size: 0.83em; margin-block-start: 1.67em; margin-block-end: 1.67em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},h6:{proto:()=>HTMLHeadingElement,attrs:{role:"heading","aria-level":"6"},style:"display: block; font-size: 0.67em; margin-block-start: 2.33em; margin-block-end: 2.33em; margin-inline-start: 0px; margin-inline-end: 0px; font-weight: bold;"},span:{proto:()=>HTMLSpanElement},pre:{proto:()=>HTMLElement,style:"display: block; font-family: monospace; white-space: pre; margin: 1em 0; --marp-auto-scaling-white-space: pre;"}},e="data-marp-auto-scaling-wrapper",i="data-marp-auto-scaling-svg",n="data-marp-auto-scaling-container";class s extends HTMLElement{container;containerSize;containerObserver;svg;svgComputedStyle;svgPreserveAspectRatio="xMinYMid meet";wrapper;wrapperSize;wrapperObserver;constructor(){super();const t=t=>([e])=>{const{width:i,height:n}=e.contentRect;this[t]={width:i,height:n},this.updateSVGRect()};this.attachShadow({mode:"open"}),this.containerObserver=new ResizeObserver(t("containerSize")),this.wrapperObserver=new ResizeObserver(((...e)=>{t("wrapperSize")(...e),this.flushSvgDisplay()}))}static get observedAttributes(){return["data-downscale-only"]}connectedCallback(){this.shadowRoot.innerHTML=`\n<style>\n  svg[${i}] { display: block; width: 100%; height: auto; vertical-align: top; }\n  span[${n}] { display: table; white-space: var(--marp-auto-scaling-white-space, nowrap); width: max-content; }\n</style>\n<div ${e}>\n  <svg part="svg" ${i}>\n    <foreignObject><span ${n}><slot></slot></span></foreignObject>\n  </svg>\n</div>\n    `.split(/\n\s*/).join(""),this.wrapper=this.shadowRoot.querySelector(`div[${e}]`)??void 0;const t=this.svg;this.svg=this.wrapper?.querySelector(`svg[${i}]`)??void 0,this.svg!==t&&(this.svgComputedStyle=this.svg?window.getComputedStyle(this.svg):void 0),this.container=this.svg?.querySelector(`span[${n}]`)??void 0,this.observe()}disconnectedCallback(){this.svg=void 0,this.svgComputedStyle=void 0,this.wrapper=void 0,this.container=void 0,this.observe()}attributeChangedCallback(){this.observe()}flushSvgDisplay(){const{svg:t}=this;t&&(t.style.display="inline",requestAnimationFrame((()=>{t.style.display=""})))}observe(){this.containerObserver.disconnect(),this.wrapperObserver.disconnect(),this.wrapper&&this.wrapperObserver.observe(this.wrapper),this.container&&this.containerObserver.observe(this.container),this.svgComputedStyle&&this.observeSVGStyle(this.svgComputedStyle)}observeSVGStyle(t){const e=()=>{const i=(()=>{const e=t.getPropertyValue("--preserve-aspect-ratio");if(e)return e.trim();return`x${(({textAlign:t,direction:e})=>{if(t.endsWith("left"))return"Min";if(t.endsWith("right"))return"Max";if("start"===t||"end"===t){let i="rtl"===e;return"end"===t&&(i=!i),i?"Max":"Min"}return"Mid"})(t)}YMid meet`})();i!==this.svgPreserveAspectRatio&&(this.svgPreserveAspectRatio=i,this.updateSVGRect()),t===this.svgComputedStyle&&requestAnimationFrame(e)};e()}updateSVGRect(){let t=Math.ceil(this.containerSize?.width??0);const e=Math.ceil(this.containerSize?.height??0);void 0!==this.dataset.downscaleOnly&&(t=Math.max(t,this.wrapperSize?.width??0));const i=this.svg?.querySelector(":scope > foreignObject");if(i?.setAttribute("width",`${t}`),i?.setAttribute("height",`${e}`),this.svg&&(this.svg.setAttribute("viewBox",`0 0 ${t} ${e}`),this.svg.setAttribute("preserveAspectRatio",this.svgPreserveAspectRatio),this.svg.style.height=t<=0||e<=0?"0":""),this.container){const t=this.svgPreserveAspectRatio.toLowerCase();this.container.style.marginLeft=t.startsWith("xmid")||t.startsWith("xmax")?"auto":"0",this.container.style.marginRight=t.startsWith("xmi")?"auto":"0"}}}const r=(t,{attrs:e={},style:i})=>class extends t{constructor(...t){super(...t);for(const[t,i]of Object.entries(e))this.hasAttribute(t)||this.setAttribute(t,i);this._shadow()}static get observedAttributes(){return["data-auto-scaling"]}connectedCallback(){this._update()}attributeChangedCallback(){this._update()}_shadow(){if(!this.shadowRoot)try{this.attachShadow({mode:"open"})}catch(t){if(!(t instanceof Error&&"NotSupportedError"===t.name))throw t}return this.shadowRoot}_update(){const t=this._shadow();if(t){const e=i?`<style>:host { ${i} }</style>`:"";let n="<slot></slot>";const{autoScaling:s}=this.dataset;if(void 0!==s){n=`<marp-auto-scaling exportparts="svg:auto-scaling" ${"downscale-only"===s?"data-downscale-only":""}>${n}</marp-auto-scaling>`}t.innerHTML=e+n}}};let o;const a=Symbol();let l;const c="marpitSVGPolyfill:setZoomFactor,",d=Symbol(),h=Symbol();const g=()=>{const t="Apple Computer, Inc."===navigator.vendor,e=t?[u]:[],i={then:e=>(t?(async()=>{if(void 0===l){const t=document.createElement("canvas");t.width=10,t.height=10;const e=t.getContext("2d"),i=new Image(10,10),n=new Promise((t=>{i.addEventListener("load",(()=>t()))}));i.crossOrigin="anonymous",i.src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%2210%22%20viewBox%3D%220%200%201%201%22%3E%3CforeignObject%20width%3D%221%22%20height%3D%221%22%20requiredExtensions%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3E%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22width%3A%201px%3B%20height%3A%201px%3B%20background%3A%20red%3B%20position%3A%20relative%22%3E%3C%2Fdiv%3E%3C%2FforeignObject%3E%3C%2Fsvg%3E",await n,e.drawImage(i,0,0),l=e.getImageData(5,5,1,1).data[3]<128}return l})().then((t=>{null==e||e(t?[u]:[])})):null==e||e([]),i)};return Object.assign(e,i)};let p,m;function u(t){const e="object"==typeof t&&t.target||document,i="object"==typeof t?t.zoom:t;window[h]||(Object.defineProperty(window,h,{configurable:!0,value:!0}),document.body.style.zoom=1.0001,document.body.offsetHeight,document.body.style.zoom=1,window.addEventListener("message",(({data:t,origin:e})=>{if(e===window.origin)try{if(t&&"string"==typeof t&&t.startsWith(c)){const[,e]=t.split(","),i=Number.parseFloat(e);Number.isNaN(i)||(m=i)}}catch(t){console.error(t)}})));let n=!1;Array.from(e.querySelectorAll("svg[data-marpit-svg]"),(t=>{var e,s,r,o;t.style.transform||(t.style.transform="translateZ(0)");const a=i||m||t.currentScale||1;p!==a&&(p=a,n=a);const l=t.getBoundingClientRect(),{length:c}=t.children;for(let i=0;i<c;i+=1){const n=t.children[i];if(n.getScreenCTM){const t=n.getScreenCTM();if(t){const i=null!==(s=null===(e=n.x)||void 0===e?void 0:e.baseVal.value)&&void 0!==s?s:0,c=null!==(o=null===(r=n.y)||void 0===r?void 0:r.baseVal.value)&&void 0!==o?o:0,d=n.children.length;for(let e=0;e<d;e+=1){const s=n.children[e];if("SECTION"===s.tagName){const{style:e}=s;e.transformOrigin||(e.transformOrigin=`${-i}px ${-c}px`),e.transform=`scale(${a}) matrix(${t.a}, ${t.b}, ${t.c}, ${t.d}, ${t.e-l.left}, ${t.f-l.top}) translateZ(0.0001px)`;break}}}}}})),!1!==n&&Array.from(e.querySelectorAll("iframe"),(({contentWindow:t})=>{null==t||t.postMessage(`${c}${n}`,"null"===window.origin?"*":window.origin)}))}function v({once:t=!1,target:e=document}={}){const i=function(t=document){if(t[d])return t[d];let e=!0;const i=()=>{e=!1,delete t[d]};Object.defineProperty(t,d,{configurable:!0,value:i});let n=[],s=!1;(async()=>{try{n=await g()}finally{s=!0}})();const r=()=>{for(const e of n)e({target:t});s&&0===n.length||e&&window.requestAnimationFrame(r)};return r(),i}(e);return t?(i(),()=>{}):i}p=1,m=void 0;const w=Symbol(),b=(e=document)=>{if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");if(((e=document)=>{const i=window[a];i||customElements.define("marp-auto-scaling",s);for(const n of Object.keys(t)){const s=`marp-${n}`,a=t[n].proto();(o??(o=!!document.createElement("div",{is:"marp-auto-scaling"}).outerHTML.startsWith("<div is"),o))&&a!==HTMLElement?i||customElements.define(s,r(a,{style:t[n].style}),{extends:n}):(i||customElements.define(s,r(HTMLElement,t[n])),e.querySelectorAll(`${n}[is="${s}"]`).forEach((t=>{t.outerHTML=t.outerHTML.replace(new RegExp(`^<${n}`,"i"),`<${s}`).replace(new RegExp(`</${n}>$`,"i"),`</${s}>`)})))}window[a]=!0})(e),e[w])return e[w];const i=v({target:e}),n=()=>{i(),delete e[w]},l=Object.assign(n,{cleanup:n,update:()=>b(e)});return Object.defineProperty(e,w,{configurable:!0,value:l}),l},y=document.currentScript;b(y?y.getRootNode():document)}();
</script></foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section data-paginate="true" data-background-image="url(./rubykaigi2025_bg.004.jpeg)" data-theme="rubykaigi2025" lang="ja-JP" data-marpit-pagination="140" style="" data-marpit-pagination-total="140" data-size="16:9" data-marpit-advanced-background="pseudo"></section></foreignObject></svg></div><div class="bespoke-marp-note" data-index="1" tabindex="0"><p>This is a first time for me to visit Matsuyama! I'm really excited to be here.</p></div><div class="bespoke-marp-note" data-index="2" tabindex="0"><p>I'm Uchio Kondo.
I'm from Fukuoka, Japan and a Product Engineer at SmartHR, which is a Ruby Kaigi platinum sponsor.
I have 2 things to advertise:</p></div><div class="bespoke-marp-note" data-index="3" tabindex="0"><p>One is about Satoru and my book. If you're interested in Ivo and yfractal's talk, I believe BPF's also helpful! Give it a shot at this lunch time!</p></div><div class="bespoke-marp-note" data-index="4" tabindex="0"><p>Ok, Today's topic is Wardite -</p></div><div class="bespoke-marp-note" data-index="5" tabindex="0"><p>What is Wardite?</p></div><div class="bespoke-marp-note" data-index="6" tabindex="0"><p>It is a WebAssembly or Wasm runtime written entirely in pure Ruby.</p></div><div class="bespoke-marp-note" data-index="7" tabindex="0"><p>Wardite is named after the real mineral Wardite, which starts with letters &quot;W&quot; and &quot;A&quot;.</p></div><div class="bespoke-marp-note" data-index="8" tabindex="0"><p>Wardite allows you to execute Wasm binaries directly within your Ruby applications.
Because it's a standard Ruby Gem, you can simply run `gem install Wardite` and start using it.</p></div><div class="bespoke-marp-note" data-index="9" tabindex="0"><p>You can also use Wardite as a library to load and interact with existing Wasm modules directly from your Ruby code.</p></div><div class="bespoke-marp-note" data-index="10" tabindex="0"><p>So let's have a look at WebAssembly.</p></div><div class="bespoke-marp-note" data-index="11" tabindex="0"><p>For a quick description: WebAssembly is a binary instruction format.
Think of it as a portable compilation target for compilers, such as rustc or clang.
Originally for browsers, Wasm is now designed to run anywhere  servers, edge devices, embedded systems, and yes, inside other applications.</p></div><div class="bespoke-marp-note" data-index="12" tabindex="0"><p>Here's a simple WebAssembly example. This C code, as you can see, just performs addition. If we compile this code into a Wasm binary, and then write JavaScript like this in the browser...</p></div><div class="bespoke-marp-note" data-index="13" tabindex="0"><p>...we can verify that the addition function, originally written in C, is now running successfully within the browser.</p></div><div class="bespoke-marp-note" data-index="14" tabindex="0"><p>Here's the flow of how a wasm program works:
First, prepare source code such as C, C++, Rust...
Then compile it into a wasm binary,
and finally, execute the wasm binary via a WebAssembly runtime</p></div><div class="bespoke-marp-note" data-index="15" tabindex="0"><p>To execute Wasm binaries, you need a Wasm runtime.
Browsers have built-in runtimes, and there are standalone ones for terminal, like Wasmtime or WasmEdge.</p></div><div class="bespoke-marp-note" data-index="16" tabindex="0"><p>Now, let's return to the topic of Wardite.</p></div><div class="bespoke-marp-note" data-index="17" tabindex="0"><p>It's a Wasm runtime for the Ruby ecosystem, built in Ruby.
Since it's written in Ruby, you can run WebAssembly within Ruby.</p></div><div class="bespoke-marp-note" data-index="18" tabindex="0"><p>A key design principle is its purity and portability:
Wardite depends only on Ruby's standard libraries. No external C dependencies or gems.
This means if you have Ruby, you can run Wardite. Maybe even on mruby, JRuby or others... in the future.</p></div><div class="bespoke-marp-note" data-index="19" tabindex="0"><p>Currently, Wardite has a near-complete implementation of the WebAssembly Core Specification and very basic WASI support.</p></div><div class="bespoke-marp-note" data-index="20" tabindex="0"><p>WebAssembly Core Spec covers the fundamental instruction set, types, and memory model needed to execute compliant Wasm files.</p></div><div class="bespoke-marp-note" data-index="21" tabindex="0"><p>Crucially, Wardite also implements WASI  the WebAssembly System Interface, specifically the common Preview 1 version.
The Core Wasm spec doesn't define how to interact with the outside world, like filesystems or clocks.</p></div><div class="bespoke-marp-note" data-index="22" tabindex="0"><p>WASI provides that standard interface.
It allows Wardite to run more complex applications compiled to Wasm, including, excitingly, Ruby itself compiled to Wasm.</p></div><div class="bespoke-marp-note" data-index="23" tabindex="0"><p>So, why did I build this? There are several reasons:</p></div><div class="bespoke-marp-note" data-index="24" tabindex="0"><p>First is to expand integration between Ruby and Wasm. The primary goal is to unlock the potential of WebAssembly's power within Ruby applications.</p></div><div class="bespoke-marp-note" data-index="25" tabindex="0"><p>Then I required High Portability. We wanted a runtime that works wherever standard Ruby works, potentially even extending to environments like mruby in the future.</p></div><div class="bespoke-marp-note" data-index="26" tabindex="0"><p>For comparison, consider other solutions such as wasmtime-rb.
During installation, these gems require either building native libraries or using pre-compiled artifacts called &quot;Fat Gems&quot;.
These requirements can potentially increase operational overhead depending on the environment.
Furthermore, separate approaches are needed for different Ruby implementations like CRuby and mruby.
Writing Wasm engine in pure Ruby provides greater maintainability and compatibility.</p></div><div class="bespoke-marp-note" data-index="27" tabindex="0"><p>And third one: Leverage Wasm's Strengths into Ruby ecosystem. Fundamentally, WebAssembly offers compelling advantages.</p></div><div class="bespoke-marp-note" data-index="28" tabindex="0"><p>But, honestly, the main reason was that I wanted to play with a complicated problem with Ruby,</p></div><div class="bespoke-marp-note" data-index="29" tabindex="0"><p>just for fun.</p></div><div class="bespoke-marp-note" data-index="30" tabindex="0"><p>In my opinion, WebAssembly holds significant potential due to several key strengths. such as:</p></div><div class="bespoke-marp-note" data-index="31" tabindex="0"><p>Language-Agnostic nature: It serves as a compilation target for many languages like Rust, Go, and C++.
And crucially, C support potentially allows C-based languages (like Ruby or Python) to run via Wasm as well.</p></div><div class="bespoke-marp-note" data-index="32" tabindex="0"><p>Also it's Embeddable &amp; Portable: Its relatively simple core specification leads to small, efficient runtimes.
This makes Wasm easy to embed securely within diverse applications.</p></div><div class="bespoke-marp-note" data-index="33" tabindex="0"><p>It's helpful to view the browser itself as just one prominent example of an environment embedding a Wasm runtime.</p></div><div class="bespoke-marp-note" data-index="34" tabindex="0"><p>And finally, it enables Polyglot Systems in the future: Combining language agnosticism with embeddability allows developers...</p></div><div class="bespoke-marp-note" data-index="35" tabindex="0"><p>...to build applications by combining components written in different languages,
choosing the best tool for each specific job.</p></div><div class="bespoke-marp-note" data-index="36" tabindex="0"><p>The diagram on the website of WasmCloud, which is an open source wasm apps orchestrator, does a really good job of showing this concept.</p></div><div class="bespoke-marp-note" data-index="37" tabindex="0"><p>In essence, Wasm's value extends well beyond just the browser, enabling flexible and powerful new ways to construct software across many environments.

Now that you understand Wardite's background, let's dive deeper.</p></div><div class="bespoke-marp-note" data-index="38" tabindex="0"><p>Let's look back at the development process of Wardite.</p></div><div class="bespoke-marp-note" data-index="39" tabindex="0"><p>There were several milestones...</p></div><div class="bespoke-marp-note" data-index="40" tabindex="0"><p>...during Wardite's development.
I'm going to describe them in order.</p></div><div class="bespoke-marp-note" data-index="41" tabindex="0"><p>The first milestone was porting a concepts from a resource called GorillaBook and getting &quot;Hello World&quot; to run in Wardite.</p></div><div class="bespoke-marp-note" data-index="42" tabindex="0"><p>GorillaBook, so named after the author's pen name, is a web book originally written for learning the basic implementation of WebAssembly using Rust.
Since I happened to have an opportunity to study it, I decided to implement a Ruby version, and that's how it started.</p></div><div class="bespoke-marp-note" data-index="43" tabindex="0"><p>My impression was that it's an excellent book, but understanding the overall design philosophy of the VM was quite challenging.</p></div><div class="bespoke-marp-note" data-index="44" tabindex="0"><p>However, the book itself includes Rust reference implementations, which was extremely helpful.

Let me briefly explain the internals of Wasm.</p></div><div class="bespoke-marp-note" data-index="45" tabindex="0"><p>First, you must parse the Wasm binary format.
However, the binary format is quite simple.</p></div><div class="bespoke-marp-note" data-index="46" tabindex="0"><p>Here's a diagram illustrating it.
It starts with some preamble, then hits a header, which contains the type and size, followed by the content of various sections. It's a simple combination of sections.</p></div><div class="bespoke-marp-note" data-index="47" tabindex="0"><p>Once the binary is parsed, the next step is just running the VM. The VM implementation is also fundamentally a loop:
fetch the current frame and an instruction, execute it, then fetch the next one.
Repeating this loop is the basic VM implementation.
This snippet is almost a real Wardite code.</p></div><div class="bespoke-marp-note" data-index="48" tabindex="0"><p>Conversely, while the VM is simple, interacting with the outside world, like handling output, is a bit more difficult.
To produce output, you must implement at least the WASI function `fd_write`. So, I implemented this as well, having the book made it manageable.</p></div><div class="bespoke-marp-note" data-index="49" tabindex="0"><p>Afrer all that coding, &quot;Hello World&quot; worked!
&quot;Hello World&quot; is always a great thing, isn't it?</p></div><div class="bespoke-marp-note" data-index="50" tabindex="0"><p>Next, I decided to cover the basic instructions of the Wasm Core Spec.</p></div><div class="bespoke-marp-note" data-index="51" tabindex="0"><p>At this point, I had a slight desire to run Ruby Wasm.</p></div><div class="bespoke-marp-note" data-index="52" tabindex="0"><p>The Wasm instruction set has a basic range and extension sets.
The Core Spec defines which instructions belong to which range. There are special extension sets for things like GC, SIMD instructions, concurrency, and others.</p></div><div class="bespoke-marp-note" data-index="53" tabindex="0"><p>This time, I focused only on the basic parts.
You can refer to the Opcode Table website to see which instructions are included in the basic set.</p></div><div class="bespoke-marp-note" data-index="54" tabindex="0"><p>The challenging part was the sheer number of instructions. Naturally.
Even focusing on the basic part, I had to implement 192 instructions.
However, each VM instruction is relatively small, so it felt like doing many small tasks diligently.</p></div><div class="bespoke-marp-note" data-index="55" tabindex="0"><p>By the way Wasm has four numeric types: integer32, integer64, float32, float64.
Often, similar instructions exist for each of these types, like Add or Sub.
For these common instructions, I created a generator to produce them collectively.
Surprisingly, it turned out there were apparently about 167 such generated instructions.</p></div><div class="bespoke-marp-note" data-index="56" tabindex="0"><p>I created a very simple template like this.</p></div><div class="bespoke-marp-note" data-index="57" tabindex="0"><p>And here's the generated code.

Okay. With the basic instructions covered, I thought about running a more practical program.</p></div><div class="bespoke-marp-note" data-index="58" tabindex="0"><p>This led to the 'grayscale journey'.</p></div><div class="bespoke-marp-note" data-index="59" tabindex="0"><p>I tried running a Rust program for grayscale conversion
that I had created for another project.</p></div><div class="bespoke-marp-note" data-index="60" tabindex="0"><p>And... it didn't work.</p></div><div class="bespoke-marp-note" data-index="61" tabindex="0"><p>Thus began the days of debugging.</p></div><div class="bespoke-marp-note" data-index="62" tabindex="0"><p>Briefly, the grayscale program takes Base64 encoded data, like a data URL, decodes it, treats the result as a PNG image, converts the pixels to grayscale, re-encodes it as a PNG, and finally encodes it back to Base64 text.</p></div><div class="bespoke-marp-note" data-index="63" tabindex="0"><p>The first issue I encountered was that
the memory allocation process wasn't working correctly.</p></div><div class="bespoke-marp-note" data-index="64" tabindex="0"><p>The fix was just one line, but it took some hard effort.</p></div><div class="bespoke-marp-note" data-index="65" tabindex="0"><p>Memory issues were fixed, but it still didn't work.
The problem was that Rust panics are translated into the Wasm `Unreachable` instruction.
`Unreachable` simply means &quot;make error if reached,&quot; which wasn't very helpful for debugging.
So, instead of letting it panic, I modified it to return the error string directly from target wasm function.</p></div><div class="bespoke-marp-note" data-index="66" tabindex="0"><p>This revealed the error message: &quot;Corrupted deflate stream.&quot;
Now I had an error ID and a message.</p></div><div class="bespoke-marp-note" data-index="67" tabindex="0"><p>I looked at the Rust code.
&quot;I see... I'm not sure.&quot;</p></div><div class="bespoke-marp-note" data-index="68" tabindex="0"><p>This part was clearly decompressing a Deflate stream, based on the function names.
I wondered if I had to study the Deflate algorithm from scratch, which felt a bit daunting.</p></div><div class="bespoke-marp-note" data-index="69" tabindex="0"><p>However, looking at the code, I could see that
bitshift operations were heavily used.
So, I decided to first verify if the bitshift and other numeric instructions were correct.</p></div><div class="bespoke-marp-note" data-index="70" tabindex="0"><p>The correctness of numeric instructions like i32 operations can be verified using the official Wasm test suite.</p></div><div class="bespoke-marp-note" data-index="71" tabindex="0"><p>Here are the testing processes.</p></div><div class="bespoke-marp-note" data-index="72" tabindex="0"><p>The official WebAssembly test suite is provided in a format called Wast.
Using a command called `wast2json`, you can generate JSON files describing the test cases,
along with the corresponding Wasm binaries needed for testing, directly from these Wast files.
Each test case specification in the JSON includes input values
and either the expected output value or the expected error that should occur.
Testing then simply involves executing the Wasm binaries according to these JSON specifications.</p></div><div class="bespoke-marp-note" data-index="73" tabindex="0"><p>I found examples where this process was automated using Python. For us, doing this with Ruby is straightforward.</p></div><div class="bespoke-marp-note" data-index="74" tabindex="0"><p>When I first ran the test cases related to i32 operations, several tests failed,
including bitshift instructions, as I somewhat expected.
After fixing all of those failures, I was able to get the grayscale example program to run successfully to completion.</p></div><div class="bespoke-marp-note" data-index="75" tabindex="0"><p>It's working correctly, right? Looks like the expected examples.</p></div><div class="bespoke-marp-note" data-index="76" tabindex="0"><p>This gave me the momentum to run something even more practical:</p></div><div class="bespoke-marp-note" data-index="77" tabindex="0"><p>Yes Ruby dot Wasm.</p></div><div class="bespoke-marp-note" data-index="78" tabindex="0"><p>Running Ruby dot Wasm requires proper WASI support in addition to the instructions.</p></div><div class="bespoke-marp-note" data-index="79" tabindex="0"><p>Building Ruby dot Wasm with default options requires...</p></div><div class="bespoke-marp-note" data-index="80" tabindex="0"><p>37 WASI functions.</p></div><div class="bespoke-marp-note" data-index="81" tabindex="0"><p>I started to implement these 37 functions,
grouping them into a single class for easy importing.</p></div><div class="bespoke-marp-note" data-index="82" tabindex="0"><p>As an example, implementing `clock_time_get` essentially just wraps Ruby's `Time.now`.
It might look a bit odd, since it's just bridging the Wasm world and the OS world using Ruby, but it is an essential process for a runtime.</p></div><div class="bespoke-marp-note" data-index="83" tabindex="0"><p>Thus, the task became diligently implementing these WASI functions one by one.
My strategy was simple:
- Repeatedly try to launch Ruby Wasm.
- When it failed saying &quot;function X is missing,&quot;
- I implemented that function. and again.</p></div><div class="bespoke-marp-note" data-index="84" tabindex="0"><p>The functions implemented were truly basic system interactions: getting arguments, current time, random numbers, environment variables, file descriptor operations etc.</p></div><div class="bespoke-marp-note" data-index="85" tabindex="0"><p>After some of these functionalities were implemented, the Ruby dot Wasm version option started working. Booyah!</p></div><div class="bespoke-marp-note" data-index="86" tabindex="0"><p>At this stage, Ruby's embedded core libraries worked, so things like `Integer#times` ran correctly.</p></div><div class="bespoke-marp-note" data-index="87" tabindex="0"><p>However, even though it could handle basic standard i/o, the file system wasn't recognized yet.
This meant `require` didn't work correctly, and loading warnings appeared.</p></div><div class="bespoke-marp-note" data-index="88" tabindex="0"><p>So, the next step was to make `require` work correctly.</p></div><div class="bespoke-marp-note" data-index="89" tabindex="0"><p>To do this, Wardite needed to recognize the file system collectively.</p></div><div class="bespoke-marp-note" data-index="90" tabindex="0"><p>So, I tried implementing the file system handling functions.
Initially, I crudely tried to make `path_open` work, assuming it would be called.
But that function wasn't even being called.
Why?</p></div><div class="bespoke-marp-note" data-index="91" tabindex="0"><p>Because I needed to correctly implement the Pre-opens mechanism first.</p></div><div class="bespoke-marp-note" data-index="92" tabindex="0"><p>Now I'll try to describe overview of preopens:</p></div><div class="bespoke-marp-note" data-index="93" tabindex="0"><p>- By default, a Wasm runtime, even with WASI enabled, cannot access the host environment's file system at all,
for security reasons.
- When launching the Wasm runtime, information about the host file systems to be shared
must be passed via pre-registered file descriptors.
- After initialization, When Runtime is goning to access the file system, it must check these pre-registered file descriptors first.
This mechanism is often referred to as Preopens.</p></div><div class="bespoke-marp-note" data-index="94" tabindex="0"><p>Looking at the WASI SDK's Lib C implementation,</p></div><div class="bespoke-marp-note" data-index="95" tabindex="0"><p>you can see a specific process.</p></div><div class="bespoke-marp-note" data-index="96" tabindex="0"><p>Inside the WASI SDK, before a program attempts to open a file, a function named `__wasilibc_populate_preopens` is called.
Within that function, it iterates through file descriptors starting from number 3,
attempting to retrieve information about pre-registered host filesystem entries.
If it successfully retrieves information for a file descriptor,
it registers the mapping between the guest path and the corresponding host path within the current process's state.
It continues this process for the next file descriptor until it encounters an error.</p></div><div class="bespoke-marp-note" data-index="97" tabindex="0"><p>Actually, functions like `path_open` are implemented such that
if no relevant preopen information has been registered, they won't even attempt to call
the underlying internal WASI function.
This appears to be a design choice focused on safety.</p></div><div class="bespoke-marp-note" data-index="98" tabindex="0"><p>So, I implemented the necessary functions related to Preopens.</p></div><div class="bespoke-marp-note" data-index="99" tabindex="0"><p>After all that, standard Ruby command started
without any loading warnings, right?
So, all's well that ends well. However...</p></div><div class="bespoke-marp-note" data-index="100" tabindex="0"><p>...</p></div><div class="bespoke-marp-note" data-index="101" tabindex="0"><p>In my environment, initializing all of RubyGems takes about 70 seconds.</p></div><div class="bespoke-marp-note" data-index="102" tabindex="0"><p>This leads into the final topic: performance.</p></div><div class="bespoke-marp-note" data-index="103" tabindex="0"><p>Now that we saw ruby.wasm working, let's talk about performance measurement.
This is still ongoing work, but I hope it's informative.</p></div><div class="bespoke-marp-note" data-index="104" tabindex="0"><p>Here are the benchmark topics:</p></div><div class="bespoke-marp-note" data-index="105" tabindex="0"><p>Additionally, the measurement premise is primarily based on the grayscale processing benchmark,
so it's heavily skewed towards numerical calculations.
Unless otherwise noted, I'm using grayscale benchmark. The software versions are as listed. I'm using an M3 Mac.</p></div><div class="bespoke-marp-note" data-index="107" tabindex="0"><p>Let's start with improvements to block jumps. WebAssembly's jump instructions (like `if, block, loop`) are a bit unusual. 
Instead of instructions holding fixed offsets, the target 'End' position is calculated dynamically when the instruction is encountered.
This was done in a method called `fetch_ops_while_end`.</p></div><div class="bespoke-marp-note" data-index="108" tabindex="0"><p>This method was dynamically calculating the corresponding 'End' position
every time an If, Block, or Loop instruction was encountered by peeking ahead at subsequent instructions.</p></div><div class="bespoke-marp-note" data-index="109" tabindex="0"><p>When I profiled the very first implementation with RubyProf,  `fetch_ops_while_end` was consuming a lot of time.
Since the calculation happened inside functions called repeatedly, it would naturally be slow.</p></div><div class="bespoke-marp-note" data-index="110" tabindex="0"><p>So, assuming that the instructions aren't dynamically rewritten, I pre-calculated the 'End' positions.</p></div><div class="bespoke-marp-note" data-index="111" tabindex="0"><p>After parsing the instructions once, I iterate through them again, calculate the 'End' positions, and cache them.
This is the implementation.</p></div><div class="bespoke-marp-note" data-index="112" tabindex="0"><p>This change reduced execution time by 43% for the grayscale benchmark. This is Wardite's first speed improvement.</p></div><div class="bespoke-marp-note" data-index="113" tabindex="0"><p>Next is instance creation, which is something I'm currently struggling with.</p></div><div class="bespoke-marp-note" data-index="114" tabindex="0"><p>Profiling Wardite using `perf` identified bottlenecks in C functions...</p></div><div class="bespoke-marp-note" data-index="115" tabindex="0"><p>...like `rb_vm_set_ivar_id` and `rb_class_new_instance_pass_kw`.</p></div><div class="bespoke-marp-note" data-index="116" tabindex="0"><p>Here's an excerpt from the perf results.</p></div><div class="bespoke-marp-note" data-index="117" tabindex="0"><p>The problem is that it's creating way too many object instances, which is slow.
Wardite's internal representation for types like integer32 or integer64 uses a simple class,
but creating these repeatedly is slow.</p></div><div class="bespoke-marp-note" data-index="118" tabindex="0"><p>How many? Using tracepoints on the grayscale benchmark, ...</p></div><div class="bespoke-marp-note" data-index="119" tabindex="0"><p>I found it creates about 18.8 million integer32 objects.
Even if creating each object took only a tiny fraction of time, this adds up significantly.</p></div><div class="bespoke-marp-note" data-index="120" tabindex="0"><p>I tried a simple experiment: memoizing frequently used integer instances.</p></div><div class="bespoke-marp-note" data-index="121" tabindex="0"><p>I memoized values from 0 to 64 and -1 as a hypothesis.</p></div><div class="bespoke-marp-note" data-index="122" tabindex="0"><p>This did result in a speedup of about 1 second in the measurement.
Note that this result includes a commit that eliminates some Object#tap calls.</p></div><div class="bespoke-marp-note" data-index="123" tabindex="0"><p>So, I've kept this optimization. However, ideally, immediate values should be used for integers and floats. But this requires significant design changes, so it's marked as a ToDo.</p></div><div class="bespoke-marp-note" data-index="124" tabindex="0"><p>There are some more TODOs:</p></div><div class="bespoke-marp-note" data-index="125" tabindex="0"><p>for example, addressing Ruby dot Wasm startup time:</p></div><div class="bespoke-marp-note" data-index="126" tabindex="0"><p>Parsing the binary file accounts for over half of the startup time.
There might be room for optimization in the binary parsing phase.Replacing it with StringScanner might be worth a try. I'm also looking into alternative methods.</p></div><div class="bespoke-marp-note" data-index="127" tabindex="0"><p>On the other hand, the impact of interactions with WASI functions appears to be relatively minimal.</p></div><div class="bespoke-marp-note" data-index="128" tabindex="0"><p>Last topic: Does YJIT help?</p></div><div class="bespoke-marp-note" data-index="129" tabindex="0"><p>Yes, it's extremely effective. All the benchmarks previously shown were run with YJIT enabled.
How effective?</p></div><div class="bespoke-marp-note" data-index="130" tabindex="0"><p>On my Arm environment, compared to running without YJIT: Ruby 3.3 showed about 52% improvement, and 3.4 showed even more. 3.4 benchmark resulted in roughly a 57% reduction in execution time.
YJIT provides a significant boost. Thank you always (to the YJIT team)!</p></div><div class="bespoke-marp-note" data-index="131" tabindex="0"><p>Before I conclude, I would like to present a startup demonstration.</p></div><div class="bespoke-marp-note" data-index="132" tabindex="0"><p>Note I run it with `disable-gems`, so it should start up in about 10 seconds.
(switch to terminal)</p></div><div class="bespoke-marp-note" data-index="133" tabindex="0"><p>Okay, thank you.

Now I've covered a lot, and I think I've said most of what I wanted to say.</p></div><div class="bespoke-marp-note" data-index="134" tabindex="0"><p>To conclude, while summarizing, let me mention one more thing. There's a next-generation Wasm format called the Component Model.</p></div><div class="bespoke-marp-note" data-index="135" tabindex="0"><p>I would like to support it eventually. That's just my intention for now, but I'm aware of it, want to do it.
Because I believe the Component Model will further enhance Wasm's language-agnostic nature, which I discussed earlier in today's talk.
And I would likely accept contributions if pull requests come in.
Otherwise, I plan to continue making steady improvements, especially focusing on compatibility and performance.</p></div><div class="bespoke-marp-note" data-index="136" tabindex="0"><p>Running a Wasm runtime purely in Ruby still feels quite like &quot;bold&quot; adventure in some ways.
I'm going bold.
But even just playing around with it might spark ideas for various interesting use cases, so please give Wardite a try.
Thank you very much for listening.</p></div><div class="bespoke-marp-note" data-index="137" tabindex="0"><p>Acknowledgements: Yuta Sato for general advice, and my colleagues at SmartHR and Fukuoka.rb members for their support. Thank you my children Kaz &amp; Kei!</p></div><div class="bespoke-marp-note" data-index="138" tabindex="0"><p>
- 
- 
- 
  - </p><p>And a final digression: this is a haiku about Sakura and a hangover.
It's a work by the founder of modern haiku-style poetry, Masaoka Shiki, who was from Matsuyama.
Let's enjoy the final day's drink ups, for those who love drinks, with respect to Shiki!</p></div><script>/*!! License: https://unpkg.com/@marp-team/marp-cli@4.1.2/lib/bespoke.js.LICENSE.txt */
!function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t,n,r=(n||(n=1,t={from:function(e,t){var n,r=1===(e.parent||e).nodeType?e.parent||e:document.querySelector(e.parent||e),o=[].filter.call("string"==typeof e.slides?r.querySelectorAll(e.slides):e.slides||r.children,(function(e){return"SCRIPT"!==e.nodeName})),a={},i=function(e,t){return(t=t||{}).index=o.indexOf(e),t.slide=e,t},s=function(e,t){a[e]=(a[e]||[]).filter((function(e){return e!==t}))},c=function(e,t){return(a[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},l=function(e,t){o[e]&&(n&&c("deactivate",i(n,t)),n=o[e],c("activate",i(n,t)))},d=function(e,t){var r=o.indexOf(n)+e;c(e>0?"next":"prev",i(n,t))&&l(r,t)},u={off:s,on:function(e,t){return(a[e]||(a[e]=[])).push(t),s.bind(null,e,t)},fire:c,slide:function(e,t){if(!arguments.length)return o.indexOf(n);c("slide",i(o[e],t))&&l(e,t)},next:d.bind(null,1),prev:d.bind(null,-1),parent:r,slides:o,destroy:function(e){c("destroy",i(n,e)),a={}}};return(t||[]).forEach((function(e){e(u)})),n||l(0),u}}),t),o=e(r);const a=document.body,i=(...e)=>history.replaceState(...e),s="",c="presenter",l="next",d=["",c,l],u="bespoke-marp-",f=`data-${u}`,m=(e,{protocol:t,host:n,pathname:r,hash:o}=location)=>{const a=e.toString();return`${t}//${n}${r}${a?"?":""}${a}${o}`},g=()=>a.dataset.bespokeView,p=e=>new URLSearchParams(location.search).get(e),v=(e,t={})=>{const n={location,setter:i,...t},r=new URLSearchParams(n.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?r.set(t,n):r.delete(t)}try{n.setter({...window.history.state??{}},"",m(r,n.location))}catch(e){console.error(e)}},h=(()=>{const e="bespoke-marp";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}})(),y=e=>{try{return localStorage.getItem(e)}catch{return null}},b=(e,t)=>{try{return localStorage.setItem(e,t),!0}catch{return!1}},w=e=>{try{return localStorage.removeItem(e),!0}catch{return!1}},x=(e,t)=>{const n="aria-hidden";t?e.setAttribute(n,"true"):e.removeAttribute(n)},k=e=>{e.parent.classList.add(`${u}parent`),e.slides.forEach((e=>e.classList.add(`${u}slide`))),e.on("activate",(t=>{const n=`${u}active`,r=t.slide,o=r.classList,a=!o.contains(n);if(e.slides.forEach((e=>{e.classList.remove(n),x(e,!0)})),o.add(n),x(r,!1),a){const e=`${n}-ready`;o.add(e),document.body.clientHeight,o.remove(e)}}))},$=e=>{let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map((e=>[null,...e.querySelectorAll("[data-marpit-fragment]")]))});const r=r=>void 0!==e.fragments[t][n+r],o=(r,o)=>{t=r,n=o,e.fragments.forEach(((e,t)=>{e.forEach(((e,n)=>{if(null==e)return;const a=t<r||t===r&&n<=o;e.setAttribute(`${f}fragment`,(a?"":"in")+"active");const i=`${f}current-fragment`;t===r&&n===o?e.setAttribute(i,"current"):e.removeAttribute(i)}))})),e.fragmentIndex=o;const a={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:o};e.fire("fragment",a)};e.on("next",(({fragment:a=!0})=>{if(a){if(r(1))return o(t,n+1),!1;const a=t+1;e.fragments[a]&&o(a,0)}else{const r=e.fragments[t].length;if(n+1<r)return o(t,r-1),!1;const a=e.fragments[t+1];a&&o(t+1,a.length-1)}})),e.on("prev",(({fragment:a=!0})=>{if(r(-1)&&a)return o(t,n-1),!1;const i=t-1;e.fragments[i]&&o(i,e.fragments[i].length-1)})),e.on("slide",(({index:t,fragment:n})=>{let r=0;if(void 0!==n){const o=e.fragments[t];if(o){const{length:e}=o;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}o(t,r)})),o(0,0)},E=document,L=()=>!(!E.fullscreenEnabled&&!E.webkitFullscreenEnabled),S=()=>!(!E.fullscreenElement&&!E.webkitFullscreenElement),P=e=>{e.fullscreen=()=>{L()&&(async()=>{S()?(E.exitFullscreen||E.webkitExitFullscreen)?.call(E):((e=E.body)=>{(e.requestFullscreen||e.webkitRequestFullscreen)?.call(e)})()})()},document.addEventListener("keydown",(t=>{"f"!==t.key&&"F11"!==t.key||t.altKey||t.ctrlKey||t.metaKey||!L()||(e.fullscreen(),t.preventDefault())}))},_=`${u}inactive`,T=(e=2e3)=>({parent:t,fire:n})=>{const r=t.classList,o=e=>n(`marp-${e?"":"in"}active`);let a;const i=()=>{a&&clearTimeout(a),a=setTimeout((()=>{r.add(_),o()}),e),r.contains(_)&&(r.remove(_),o(!0))};for(const e of["mousedown","mousemove","touchend"])document.addEventListener(e,i);setTimeout(i,0)},I=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"],M=e=>{e.parent.addEventListener("keydown",(e=>{if(!e.target)return;const t=e.target;(I.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()}))},O=e=>{window.addEventListener("load",(()=>{for(const t of e.slides){const e=t.querySelector("marp-auto-scaling, [data-auto-scaling], [data-marp-fitting]");t.setAttribute(`${f}load`,e?"":"hideable")}}))},A=({interval:e=250}={})=>t=>{document.addEventListener("keydown",(e=>{if(" "===e.key&&e.shiftKey)t.prev();else if("ArrowLeft"===e.key||"ArrowUp"===e.key||"PageUp"===e.key)t.prev({fragment:!e.shiftKey});else if(" "!==e.key||e.shiftKey)if("ArrowRight"===e.key||"ArrowDown"===e.key||"PageDown"===e.key)t.next({fragment:!e.shiftKey});else if("End"===e.key)t.slide(t.slides.length-1,{fragment:-1});else{if("Home"!==e.key)return;t.slide(0)}else t.next();e.preventDefault()}));let n,r,o=0;t.parent.addEventListener("wheel",(a=>{let i=!1;const s=(e,t)=>{e&&(i=i||((e,t)=>((e,t)=>{const n="X"===t?"Width":"Height";return e[`client${n}`]<e[`scroll${n}`]})(e,t)&&((e,t)=>{const{overflow:n}=e,r=e[`overflow${t}`];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r})(getComputedStyle(e),t))(e,t)),e?.parentElement&&s(e.parentElement,t)};if(0!==a.deltaX&&s(a.target,"X"),0!==a.deltaY&&s(a.target,"Y"),i)return;a.preventDefault();const c=Math.sqrt(a.deltaX**2+a.deltaY**2);if(void 0!==a.wheelDelta){if(void 0===a.webkitForce&&Math.abs(a.wheelDelta)<40)return;if(a.deltaMode===a.DOM_DELTA_PIXEL&&c<4)return}else if(a.deltaMode===a.DOM_DELTA_PIXEL&&c<12)return;r&&clearTimeout(r),r=setTimeout((()=>{n=0}),e);const l=Date.now()-o<e,d=c<=n;if(n=c,l||d)return;let u;(a.deltaX>0||a.deltaY>0)&&(u="next"),(a.deltaX<0||a.deltaY<0)&&(u="prev"),u&&(t[u](),o=Date.now())}))},C=(e=`.${u}osc`)=>{const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[${f}osc=${JSON.stringify(e)}]`).forEach(n)};return L()||n("fullscreen",(e=>e.style.display="none")),h||n("presenter",(e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."})),e=>{t.addEventListener("click",(t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;n&&t.target.blur();const r={fragment:!t.shiftKey};"next"===n?e.next(r):"prev"===n?e.prev(r):"fullscreen"===n?e?.fullscreen():"presenter"===n&&e.openPresenterView()}})),e.parent.appendChild(t),e.on("activate",(({index:t})=>{n("page",(n=>n.textContent=`Page ${t+1} of ${e.slides.length}`))})),e.on("fragment",(({index:t,fragments:r,fragmentIndex:o})=>{n("prev",(e=>e.disabled=0===t&&0===o)),n("next",(n=>n.disabled=t===e.slides.length-1&&o===r.length-1))})),e.on("marp-active",(()=>x(t,!1))),e.on("marp-inactive",(()=>x(t,!0))),L()&&(e=>{for(const t of["","webkit"])E.addEventListener(t+"fullscreenchange",e)})((()=>n("fullscreen",(e=>e.classList.toggle("exit",L()&&S())))))}},D=e=>{window.addEventListener("message",(t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");let o=Number.parseInt(t,10),a=Number.parseInt(n,10)+1;a>=e.fragments[o].length&&(o+=1,a=0),e.slide(o,{fragment:a})}}))};var N,B,q,K,j,F,V,U={exports:{}},X=(N||(N=1,U.exports=(B=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],q=function(e){return String(e).replace(/[&<>"']/g,(function(e){return"&"+K[e]+";"}))},K={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},j="dangerouslySetInnerHTML",F={className:"class",htmlFor:"for"},V={},function(e,t){var n=[],r="";t=t||{};for(var o=arguments.length;o-- >2;)n.push(arguments[o]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(var a in t)!1!==t[a]&&null!=t[a]&&a!==j&&(r+=" "+(F[a]?F[a]:q(a))+'="'+q(t[a])+'"');r+=">"}if(-1===B.indexOf(e)){if(t[j])r+=t[j].__html;else for(;n.length;){var i=n.pop();if(i)if(i.pop)for(var s=i.length;s--;)n.push(i[s]);else r+=!0===V[i]?i:q(i)}r+=e?"</"+e+">":""}return V[r]=!0,r})),U.exports),H=e(X);const R=({children:e})=>H(null,null,...e),W=`${u}presenter-`,J={container:`${W}container`,dragbar:`${W}dragbar-container`,next:`${W}next`,nextContainer:`${W}next-container`,noteContainer:`${W}note-container`,noteWrapper:`${W}note-wrapper`,noteButtons:`${W}note-buttons`,infoContainer:`${W}info-container`,infoPage:`${W}info-page`,infoPageText:`${W}info-page-text`,infoPagePrev:`${W}info-page-prev`,infoPageNext:`${W}info-page-next`,noteButtonsBigger:`${W}note-bigger`,noteButtonsSmaller:`${W}note-smaller`,infoTime:`${W}info-time`,infoTimer:`${W}info-timer`},Y=e=>{const{title:t}=document;document.title="[Presenter view]"+(t?` - ${t}`:"");const n={},r=e=>(n[e]=n[e]||document.querySelector(`.${e}`),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=J.container,t.appendChild(e),t.insertAdjacentHTML("beforeend",H(R,null,H("div",{class:J.nextContainer},H("iframe",{class:J.next,src:"?view=next"})),H("div",{class:J.dragbar}),H("div",{class:J.noteContainer},H("div",{class:J.noteWrapper}),H("div",{class:J.noteButtons},H("button",{class:J.noteButtonsSmaller,tabindex:"-1",title:"Smaller notes font size"},"Smaller notes font size"),H("button",{class:J.noteButtonsBigger,tabindex:"-1",title:"Bigger notes font size"},"Bigger notes font size"))),H("div",{class:J.infoContainer},H("div",{class:J.infoPage},H("button",{class:J.infoPagePrev,tabindex:"-1",title:"Previous"},"Previous"),H("span",{class:J.infoPageText}),H("button",{class:J.infoPageNext,tabindex:"-1",title:"Next"},"Next")),H("time",{class:J.infoTime,title:"Current time"}),H("time",{class:J.infoTimer,title:"Timer"})))),t})(e.parent)),(e=>{let t=!1;r(J.dragbar).addEventListener("mousedown",(()=>{t=!0,r(J.dragbar).classList.add("active")})),window.addEventListener("mouseup",(()=>{t=!1,r(J.dragbar).classList.remove("active")})),window.addEventListener("mousemove",(e=>{if(!t)return;const n=e.clientX/document.documentElement.clientWidth*100;r(J.container).style.setProperty("--bespoke-marp-presenter-split-ratio",`${Math.max(0,Math.min(100,n))}%`)})),r(J.nextContainer).addEventListener("click",(()=>e.next()));const n=r(J.next),o=(a=n,(e,t)=>a.contentWindow?.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin));var a;n.addEventListener("load",(()=>{r(J.nextContainer).classList.add("active"),o(e.slide(),e.fragmentIndex),e.on("fragment",(({index:e,fragmentIndex:t})=>o(e,t)))}));const i=document.querySelectorAll(".bespoke-marp-note");i.forEach((e=>{e.addEventListener("keydown",(e=>e.stopPropagation())),r(J.noteWrapper).appendChild(e)})),e.on("activate",(()=>i.forEach((t=>t.classList.toggle("active",t.dataset.index==e.slide())))));let s=0;const c=e=>{s=Math.max(-5,s+e),r(J.noteContainer).style.setProperty("--bespoke-marp-note-font-scale",(1.2**s).toFixed(4))},l=()=>c(1),d=()=>c(-1),u=r(J.noteButtonsBigger),f=r(J.noteButtonsSmaller);u.addEventListener("click",(()=>{u.blur(),l()})),f.addEventListener("click",(()=>{f.blur(),d()})),document.addEventListener("keydown",(e=>{"+"===e.key&&l(),"-"===e.key&&d()}),!0),e.on("activate",(({index:t})=>{r(J.infoPageText).textContent=`${t+1} / ${e.slides.length}`}));const m=r(J.infoPagePrev),g=r(J.infoPageNext);m.addEventListener("click",(t=>{m.blur(),e.prev({fragment:!t.shiftKey})})),g.addEventListener("click",(t=>{g.blur(),e.next({fragment:!t.shiftKey})})),e.on("fragment",(({index:t,fragments:n,fragmentIndex:r})=>{m.disabled=0===t&&0===r,g.disabled=t===e.slides.length-1&&r===n.length-1}));let p=new Date;const v=()=>{const e=new Date,t=e=>`${Math.floor(e)}`.padStart(2,"0"),n=e.getTime()-p.getTime(),o=t(n/1e3%60),a=t(n/1e3/60%60),i=t(n/36e5%24);r(J.infoTime).textContent=e.toLocaleTimeString(),r(J.infoTimer).textContent=`${i}:${a}:${o}`};v(),setInterval(v,250),r(J.infoTimer).addEventListener("click",(()=>{p=new Date}))})(e)},z=e=>{if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:G},presenterUrl:{enumerable:!0,get:Q}}),h&&document.addEventListener("keydown",(t=>{"p"!==t.key||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())}))};function G(){const{max:e,floor:t}=Math,n=e(t(.85*window.innerWidth),640),r=e(t(.85*window.innerHeight),360);return window.open(this.presenterUrl,W+this.syncKey,`width=${n},height=${r},menubar=no,toolbar=no`)}function Q(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),m(e)}const Z=e=>{const t=g();return t===l&&e.appendChild(document.createElement("span")),{[s]:z,[c]:Y,[l]:D}[t]},ee=e=>{e.on("activate",(t=>{document.querySelectorAll(".bespoke-progress-parent > .bespoke-progress-bar").forEach((n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"}))}))},te=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t},ne=(e={})=>{const t={history:!0,...e};return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},o=(t={fragment:!0})=>{let n=t.fragment?te(p("f")||""):null;((t,n)=>{const{min:r,max:o}=Math,{fragments:a,slides:i}=e,s=o(0,r(t,i.length-1)),c=o(0,r(n||0,a[s].length-1));s===e.slide()&&c===e.fragmentIndex||e.slide(s,{fragment:c})})((()=>{if(location.hash){const[t]=location.hash.slice(1).split(":~:");if(/^\d+$/.test(t))return(te(t)??1)-1;const r=document.getElementById(t)||document.querySelector(`a[name="${CSS.escape(t)}"]`);if(r){const{length:t}=e.slides;for(let o=0;o<t;o+=1)if(e.slides[o].contains(r)){const t=e.fragments?.[o],a=r.closest("[data-marpit-fragment]");if(t&&a){const e=t.indexOf(a);e>=0&&(n=e)}return o}}}return 0})(),n)};e.on("fragment",(({index:e,fragmentIndex:r})=>{n||v({f:0===r||r.toString()},{location:{...location,hash:`#${e+1}`},setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})})),setTimeout((()=>{o(),window.addEventListener("hashchange",(()=>r((()=>{o({fragment:!1}),v({f:void 0})})))),window.addEventListener("popstate",(()=>{n||r((()=>o()))})),n=!1}),0)}},re=(e={})=>{const t=e.key||window.history.state?.marpBespokeSyncKey||Math.random().toString(36).slice(2),n=`bespoke-marp-sync-${t}`;var r;r={marpBespokeSyncKey:t},v({},{setter:(e,...t)=>i({...e,...r},...t)});const o=()=>{const e=y(n);return e?JSON.parse(e):Object.create(null)},a=e=>{const t=o(),r={...t,...e(t)};return b(n,JSON.stringify(r)),r},s=()=>{window.removeEventListener("pageshow",s),a((e=>({reference:(e.reference||0)+1})))};return e=>{s(),Object.defineProperty(e,"syncKey",{value:t,enumerable:!0});let r=!0;setTimeout((()=>{e.on("fragment",(e=>{r&&a((()=>({index:e.index,fragmentIndex:e.fragmentIndex})))}))}),0),window.addEventListener("storage",(t=>{if(t.key===n&&t.oldValue&&t.newValue){const n=JSON.parse(t.oldValue),o=JSON.parse(t.newValue);if(n.index!==o.index||n.fragmentIndex!==o.fragmentIndex)try{r=!1,e.slide(o.index,{fragment:o.fragmentIndex,forSync:!0})}finally{r=!0}}}));const i=()=>{const{reference:e}=o();void 0===e||e<=1?w(n):a((()=>({reference:e-1})))};window.addEventListener("pagehide",(e=>{e.persisted&&window.addEventListener("pageshow",s),i()})),e.on("destroy",i)}},{PI:oe,abs:ae,sqrt:ie,atan2:se}=Math,ce={passive:!0},le=({slope:e=-.7,swipeThreshold:t=30}={})=>n=>{let r;const o=n.parent,a=e=>{const t=o.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};o.addEventListener("touchstart",(({touches:e})=>{r=1===e.length?a(e[0]):void 0}),ce),o.addEventListener("touchmove",(e=>{if(r)if(1===e.touches.length){e.preventDefault();const t=a(e.touches[0]),n=t.x-r.x,o=t.y-r.y;r.delta=ie(ae(n)**2+ae(o)**2),r.radian=se(n,o)}else r=void 0})),o.addEventListener("touchend",(o=>{if(r){if(r.delta&&r.delta>=t&&r.radian){const t=(r.radian-e+oe)%(2*oe)-oe;n[t<0?"next":"prev"](),o.stopPropagation()}r=void 0}}),ce)},de=new Map;de.clear(),de.set("none",{backward:{both:void 0,incoming:void 0,outgoing:void 0},forward:{both:void 0,incoming:void 0,outgoing:void 0}});const ue={both:"",outgoing:"outgoing-",incoming:"incoming-"},fe={forward:"",backward:"-backward"},me=e=>`--marp-bespoke-transition-animation-${e}`,ge=e=>`--marp-transition-${e}`,pe=me("name"),ve=me("duration"),he=e=>new Promise((t=>{const n={},r=document.createElement("div"),o=e=>{r.remove(),t(e)};r.addEventListener("animationstart",(()=>o(n))),Object.assign(r.style,{animationName:e,animationDuration:"1s",animationFillMode:"both",animationPlayState:"paused",position:"absolute",pointerEvents:"none"}),document.body.appendChild(r);const a=getComputedStyle(r).getPropertyValue(ge("duration"));a&&(n.defaultDuration=a),((e,t)=>{requestAnimationFrame((()=>{e.style.animationPlayState="running",requestAnimationFrame((()=>t(void 0)))}))})(r,o)})),ye=async e=>de.has(e)?de.get(e):(e=>{const t={},n=[];for(const[r,o]of Object.entries(ue))for(const[a,i]of Object.entries(fe)){const s=`marp-${o}transition${i}-${e}`;n.push(he(s).then((e=>{t[a]=t[a]||{},t[a][r]=e?{...e,name:s}:void 0})))}return Promise.all(n).then((()=>t))})(e).then((t=>(de.set(e,t),t))),be=e=>Object.values(e).flatMap(Object.values).every((e=>!e)),we=(e,{type:t,backward:n})=>{const r=e[n?"backward":"forward"],o=(()=>{const e=r[t],n=e=>({[pe]:e.name});if(e)return n(e);if(r.both){const e=n(r.both);return"incoming"===t&&(e[me("direction")]="reverse"),e}})();return!o&&n?we(e,{type:t,backward:!1}):o||{[pe]:"__bespoke_marp_transition_no_animation__"}},xe=e=>{if(e)try{const t=JSON.parse(e);if((e=>{if("object"!=typeof e)return!1;const t=e;return"string"==typeof t.name&&(void 0===t.duration||"string"==typeof t.duration)})(t))return t}catch{}},ke="_tSId",$e="_tA",Ee="bespoke-marp-transition-warming-up",Le=window.matchMedia("(prefers-reduced-motion: reduce)"),Se="__bespoke_marp_transition_reduced_outgoing__",Pe="__bespoke_marp_transition_reduced_incoming__",_e={forward:{both:void 0,incoming:{name:Pe},outgoing:{name:Se}},backward:{both:void 0,incoming:{name:Pe},outgoing:{name:Se}}},Te=e=>{if(!document.startViewTransition)return;const t=t=>(void 0!==t&&(e._tD=t),e._tD);let n;t(!1),((...e)=>{const t=[...new Set(e).values()];return Promise.all(t.map((e=>ye(e)))).then()})(...Array.from(document.querySelectorAll("section[data-transition], section[data-transition-back]")).flatMap((e=>[e.dataset.transition,e.dataset.transitionBack].flatMap((e=>{const t=xe(e);return[t?.name,t?.builtinFallback?`__builtin__${t.name}`:void 0]})).filter((e=>!!e))))).then((()=>{document.querySelectorAll("style").forEach((e=>{e.innerHTML=e.innerHTML.replace(/--marp-transition-duration:[^;}]*[;}]/g,(e=>e.slice(0,-1)+"!important"+e.slice(-1)))}))}));const r=(n,{back:r,cond:o})=>a=>{const i=t();if(i)return!!a[$e]||!("object"!=typeof i||(i.skipTransition(),!a.forSync));if(!o(a))return!0;const s=e.slides[e.slide()],c=()=>a.back??r,l="data-transition"+(c()?"-back":""),d=s.querySelector(`section[${l}]`);if(!d)return!0;const u=xe(d.getAttribute(l)??void 0);return!u||((async(e,{builtinFallback:t=!0}={})=>{let n=await ye(e);if(be(n)){if(!t)return;return n=await ye(`__builtin__${e}`),be(n)?void 0:n}return n})(u.name,{builtinFallback:u.builtinFallback}).then((e=>{if(!e){t(!0);try{n(a)}finally{t(!1)}return}let r=e;Le.matches&&(console.warn("Use a constant animation to transition because preferring reduced motion by viewer has detected."),r=_e);const o=document.getElementById(ke);o&&o.remove();const i=document.createElement("style");i.id=ke,document.head.appendChild(i),((e,t)=>{const n=[`:root{${ge("direction")}:${t.backward?-1:1};}`,":root:has(.bespoke-marp-inactive){cursor:none;}"],r=t=>{const n=e[t].both?.defaultDuration||e[t].outgoing?.defaultDuration||e[t].incoming?.defaultDuration;return"forward"===t?n:n||r("forward")},o=t.duration||r(t.backward?"backward":"forward");void 0!==o&&n.push(`::view-transition-group(*){${ve}:${o};}`);const a=e=>Object.entries(e).map((([e,t])=>`${e}:${t};`)).join("");return n.push(`::view-transition-old(root){${a(we(e,{...t,type:"outgoing"}))}}`,`::view-transition-new(root){${a(we(e,{...t,type:"incoming"}))}}`),n})(r,{backward:c(),duration:u.duration}).forEach((e=>i.sheet?.insertRule(e)));const s=document.documentElement.classList;s.add(Ee);let l=!1;const d=()=>{l||(n(a),l=!0,s.remove(Ee))},f=()=>{t(!1),i.remove(),s.remove(Ee)};try{t(!0);const e=document.startViewTransition(d);t(e),e.finished.finally(f)}catch(e){console.error(e),d(),f()}})),!1)};e.on("prev",r((t=>e.prev({...t,[$e]:!0})),{back:!0,cond:e=>e.index>0&&!((e.fragment??1)&&n.fragmentIndex>0)})),e.on("next",r((t=>e.next({...t,[$e]:!0})),{cond:t=>t.index+1<e.slides.length&&!(n.fragmentIndex+1<n.fragments.length)})),setTimeout((()=>{e.on("slide",r((t=>e.slide(t.index,{...t,[$e]:!0})),{cond:t=>{const n=e.slide();return t.index!==n&&(t.back=t.index<n,!0)}}))}),0),e.on("fragment",(e=>{n=e}))};let Ie;const Me=()=>(void 0===Ie&&(Ie="wakeLock"in navigator&&navigator.wakeLock),Ie),Oe=async()=>{const e=Me();if(e)try{return await e.request("screen")}catch(e){console.warn(e)}return null},Ae=async()=>{if(!Me())return;let e;const t=()=>{e&&"visible"===document.visibilityState&&Oe()};for(const e of["visibilitychange","fullscreenchange"])document.addEventListener(e,t);return e=await Oe(),e};((e=document.getElementById(":$p"))=>{(()=>{const e=p("view");a.dataset.bespokeView=e===l||e===c?e:""})();const t=(e=>{const t=p(e);return v({[e]:void 0}),t})("sync")||void 0;o.from(e,((...e)=>{const t=d.findIndex((e=>g()===e));return e.map((([e,n])=>e[t]&&n)).filter((e=>e))})([[1,1,0],re({key:t})],[[1,1,1],Z(e)],[[1,1,0],M],[[1,1,1],k],[[1,0,0],T()],[[1,1,1],O],[[1,1,1],ne({history:!1})],[[1,1,0],A()],[[1,1,0],P],[[1,0,0],ee],[[1,1,0],le()],[[1,0,0],C()],[[1,0,0],Te],[[1,1,1],$],[[1,1,0],Ae]))})()}();</script></body></html>